<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bypass heuristic based detection(theory)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Bypass heuristic based detection(theory)</h1><br/><p><h2>Intro</h2><ul><li>• <small>• heuristic based simulates the execution of the file </small></li><li><small>basic approach : stager behaves differently when emulated vs when executed </small></li></ul></p><p></p><p></p><p><h2>Approach : sleep time</h2><ul><li>• <small>• av will fast forward when countering win32 sleep</small></li><li><small>we can use this by comparing time of the day vs time of execution</small> </li><li></li></ul><img src="images/13-1.png" alt="images/13-1.png" /><ul><li>we can bypass windows defender via this method </li></ul></p><p></p><p></p><p></p><p><h2>Approach 2 : non emulated API</h2><ul><li>• <small>• test various APis against AV engine and check if they are emulated </small></li><li><small>e.g VirtualAllocEXNuma </small><ul><li></li></ul></li></ul><img src="images/13-2.png" alt="images/13-2.png" /></p></div>
</body>
</html>
