<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>08- Other  vulns</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>08- Other  vulns</h1><br/><p><em><h2>Deserialization : python (pickle)</h2></em><ul><li><em><h3>• </h3></em>•   <h3>The pickle module is not secure. Only unpickle data you trust.</h3></li><li>◇ <h3>◇ ▪ dumps() – This function is called to serialize an object hierarchy.</h3></li></ul><h3></h3></p><p><h3> ▪ loads() – This function is called to de-serialize a data stream</h3><h3></h3></p><p><h3> ▪ dumps() – This function is called to serialize an object hierarchy.</h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><ul><li><h3>  common attack:pickle diserialisation and command injection attack</h3></li><li><h3>• </h3>•  <h3>▪ https://hackernoon.com/10-common-security-gotchas-in-python-and-how-to-avoid-them-e19fbe265e03</h3></li></ul><h3></h3></p><p><h3> </h3></p><p></p><p></p><p></p><p><em><h2></h2></em></p><p><em><h2> SSTI </h2></em><ul><li> when you have reflection + language that uses templates like python</li><li></li></ul><a href="https://miro.medium.com/max/933/1*ZZsBz097SfGpaP022x0S2g.png"><img src="images/23-1.png" alt="images/23-1.png" /></a><ul><li> CASE 1 : {{1+2}} == 3</li><li>usually happens when we have flask / ninja</li><li> In python __mro__ or mro() allows us to go back up the tree of inherited objects in the current Python environment.</li><li>POst  exploit :<ul><li> {{ config.items() }}</li><li>look for subProcess.Popen </li><li> &quot;&quot;.__class__.__mro__[1].__subclasses__()</li><li></li></ul></li></ul></p><p><ul><li>most popular template engines:<ul><li>PHP – Smarty, Twigs</li><li>Java – Velocity, Freemaker</li><li>Python – JINJA, Mako, Tornado</li><li>JavaScript – Jade, Rage*</li><li>Ruby – Liquid</li></ul></li></ul></p><p><ul><li>ssti fuzzing string </li></ul><h3></h3></p><p><h3>  •  </h3><h3>https://cobalt.io/blog/a-pentesters-guide-to-server-side-template-injection-ssti</h3><h3> </h3><h3></h3></p><p><h3></h3>  •  parameter=${{&lt;%[%&#39;&quot;}}%\.</p><p>  •  to identify the template engine read the error message</p><p>  •  if error not displayed we can test:<ul><li>=${7*3}</li><li>={{7*3}}</li><li>=&lt;%= 7*3 %&gt; </li><li>&lt;%= 7*7 %&gt; // vbscript wscrip.shell<ul><li>&lt;% response.write &quot;test” %&gt;<ul><li>&lt;%= CreateObject(&quot;Wscript.Shell&quot;).exec(&quot;whoami&quot;).StdOut.ReadAll() %&gt;</li></ul></li></ul></li></ul><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h2>file upload injection </h2><ul><li><strong><h3>◇ </h3></strong>◇ <h3> https://medium.com/@519udhaya/unrestricted-file-upload-vulnerability-bba4491a08da</h3></li></ul></p><p></p><p><h3></h3></p><p><h3></h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><strong><h3>Cookies malformation</h3></strong><ul><li><h3>  send login request to burp sequencer: it will tell you if the cookie is bruteforceable </h3></li></ul><h3></h3></p><p><h3>  •   save tokens </h3><h3></h3></p><p><h3>  •   sort &lt;login_cookies&gt;|uniq -c </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h3></h3></p><p><h3> </h3></p><p><h2>## 302 REDIRECT BYPASS</h2><h3> </h3><ul><li><h3>  change 302 to 200 in order to get content</h3></li><li><h3> common flaw when not dealing with frameworks </h3></li></ul><h3></h3></p><p><h3> </h3></p><p></p><p><h2>Server Side Include injection (SSI)</h2><ul><li>Server Side Includes (SSI) is a simple interpreted server-side scripting language used almost exclusively for the World Wide Web. It is most useful for including the contents of one or more files into a web page on a web server (see below), using its #include directive.</li><li>SSIs are directives present on Web applications used to feed an HTML page with dynamic contents</li><li>supported by nginx , apache ...</li><li>output is .shtm / .shtml / .stm</li><li>SSI syntax <ul><li>&lt;!--#directive parameter=value parameter=value --&gt;</li></ul></li><li>Exploit <ul><li>It is possible to check if the application is properly validating input fields data by inserting characters that are used in SSI directives, like: &lt; ! # = / . &quot; - &gt; and [a-zA-Z0-9] </li><li><a href="https://owasp.org/www-community/attacks/Server-Side_Includes_(SSI)_Injection">https://owasp.org/www-community/attacks/Server-Side_Includes_(SSI)_Injection</a></li><li>&lt;!--#echo var=&quot;flag&quot; --&gt;</li></ul></li></ul></p><p></p><p></p><p></p><p><h2>HTTP request smuggling</h2><ul><li></li></ul><img src="images/23-2.png" alt="images/23-2.png" /><ul><li>the backend receives multiple commands in the same connection </li><li>he gets the start and end of request from headers <ul><li>Content-Length:&lt;body_length&gt;</li><li>Transfer Encoding:chunk<ul><li>encode the body with certain form</li></ul></li></ul></li><li>Vulnerability: frontend use Content Length and backend use Transfer encoding </li><li>exploit:<ul><li>add Transfer encoding : chunk=0</li><li>=&gt; data is a new request </p><p></li></ul></li></ul></p></div>
</body>
</html>
