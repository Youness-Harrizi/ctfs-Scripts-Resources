<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>winrm</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>winrm</h1><br/><p><h2>Configure Winrm: target via GUI</h2></p><p><ol><li>start winrm service<ol><li>run =&gt; services.msc =&gt; windows remote management (Gestion à distance)</li><li>run =&gt; gpedit.msc // open group policy editor<ol><li></li></ol></li></ol></li></ol><img src="images/67-1.png" alt="images/67-1.png" /><ol><li>enable winrm and set IP filters to *</li></ol></li><li>open windows advance firewall and enable winrm incoming connection<ol><li>windows remote management HTTP-in (Getsion à distance de windows mode entrée =&gt; activer la règle </li></ol></li><li>create demouser (compmgmt.msc) and add it to Remote Managemnt users group </p><p> </p><p><h2>Configure WINRM target : Powershell</h2><ol><li>Get-Service winrm </li><li>Start-Service Winrm </li><li>Set-WSManQuickConfig<ol><li> Starts the WinRM service.</li><li> Sets the startup type on the WinRM service to Automatic.</li><li> Creates a listener to accept requests on any IP address.</li><li> Enables a firewall exception for WS-Management communications.</li><li>Creates the simple and long name session endpoint configurations if needed.</li><li> Enables all session configurations.</li><li> Changes the security descriptor of all session configurations to allow remote access. </li></ol></li><li>3. Create user <ol><li>$secureString = convertto-securestring &quot;password_123321&quot; -asplaintext -force</li></ol></li></ol></p><p>New-LocalUser &quot;winrmdemo&quot; -Password $secureString -FullName &quot;WinRM Demo&quot; -Description</p><p>&quot;WinRM Demo Account&quot;</p><p>Add-LocalGroupMember -Name &#39;Administrators&#39; -Member &#39;winrmdemo&#39;</p><p> </p><p> </p><p> </p><p><h2> Configure WINRM : attacking machine windows: GUI</h2><ol><li>  start winrm service </li><li></li></ol><img src="images/67-2.png" alt="images/67-2.png" /><ol><li>enable trusted hosts and add &quot;*” to teh list  </li></ol></li><li>Powershell<ol><li>$cred=Get-cred</li><li>Invoke-Command -ComputerName $target -ScriptBlock {Get-Process} -Crdential $cred</li></ol></p><p></p><p></p><p></p><p><h1>Configure WINRM client : Powershell</h1></p><p><ol><li>start-service winrm</li><li>Set-item wsman:localhost\client\trustedhosts -value *<ol><li>// set the trusted hosts to *</p><p></li></ol></li></ol></p></div>
</body>
</html>
