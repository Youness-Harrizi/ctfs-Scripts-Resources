<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>02-disassemble APK</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>02-disassemble APK</h1><br/><p><h1>Understanding the Manifest</h1><ul><li>package name</li><li>permissions</li></ul></p><p>  <table class="table"><tr><th>Permission(s)</th><th>What it allows</th><th>Security / Privacy risk</th></tr><tr><td>READ_SMS, SEND_SMS, RECEIVE_SMS</td><td>Read, send, and receive SMS messages.</td><td>Interception of one-time passwords (OTPs) for 2FA and sending unauthorized SMS messages.</td></tr><tr><td>READ_CALL_LOG, WRITE_CALL_LOG</td><td>Access and modify the device’s call history.</td><td>Exposure of sensitive metadata about communication patterns or hiding malicious calls.</td></tr><tr><td>READ_CONTACTS, WRITE_CONTACTS</td><td>Access and modify the device’s contact list.</td><td>Exfiltration of contact data or injection of fraudulent contacts for social engineering or spam.</td></tr><tr><td>ACCESS_FINE_LOCATION, ACCESS_COARSE_LOCATION</td><td>Access the device’s precise or approximate location.</td><td>Real-time tracking of the user’s physical movements without consent.</td></tr><tr><td>READ_EXTERNAL_STORAGE, WRITE_EXTERNAL_STORAGE</td><td>Access and modify files on external storage.</td><td>Exposure, tampering, or deletion of sensitive files, especially if they’re not securely stored.</td></tr><tr><td>GET_ACCOUNTS</td><td>Query the list of accounts registered on the device.</td><td>Targeting specific accounts or harvesting data for phishing and account-takeover attempts.</td></tr><tr><td>CAMERA</td><td>Use the device’s camera hardware.</td><td>Covert photo or video capture without the user’s knowledge.</td></tr><tr><td>RECORD_AUDIO</td><td>Capture audio via the device’s microphone.</td><td>Eavesdropping on conversations in the background.</td></tr><tr><td>INSTALL_PACKAGES, REQUEST_INSTALL_PACKAGES</td><td>Trigger installation of app packages via the system installer.</td><td>Silent or deceptive installation of additional malicious apps.</td></tr><tr><td>SYSTEM_ALERT_WINDOW</td><td>Draw overlays on top of other apps.</td><td>Creating deceptive UI overlays for phishing or tricking users into unintended actions (e.g., tapping “Allow” instead of “Deny”).</td></tr></table></p><p><ul><li>application<ul><li></li></ul></li></ul><img src="images/3-1.png" alt="images/3-1.png" /></p><p></p><p><ul><li>init subclasses are initiated before user interaction so it should be investigated </li></ul></p><p></p><p></p><p></p><p><h1>network security config</h1></p><p><ul><li>vim myapp/res/xml/network_security_config.xml</li><li></li></ul><img src="images/3-2.png" alt="images/3-2.png" /><ul><li>only HTTPS connections is allowed for communication with ip 192.168.1.20 and myapp/res/raw/certificate.der is used </li></ul></li><li><img src="images/3-3.png" alt="images/3-3.png" /><ul><li>certificate pining implementation that prevent MITM </li></ul></p><p></p><p></p><p><h1>Manifest - Components</h1></p><p><ul><li>The android:exported=&quot;true&quot; attribute of an Activity is critical, as it indicates that the component is accessible to other apps<ul><li>deep links </li><li></li></ul></li></ul><img src="images/3-4.png" alt="images/3-4.png" /><ul><li>lack of validation in deep links could lead to vulns </li></ul></p></div>
</body>
</html>
