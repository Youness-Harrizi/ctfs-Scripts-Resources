<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>23-exchange servers</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>23-exchange servers</h1><br/><p>Let&#39;s break these two down clearly, especially from an <strong>offensive security</strong> and <strong>penetration testing</strong> perspective:</p><p></p><p><h2>What Are Exchange Servers?</h2></p><p><strong>Microsoft Exchange Server</strong> is a <strong>mail and calendaring server</strong> developed by Microsoft. It runs on Windows Server and is used primarily by organizations for:<ul><li>Email handling (SMTP, POP, IMAP, MAPI)</li></ul></p><p><ul><li>Calendars</li></ul></p><p><ul><li>Contacts</li></ul></p><p><ul><li>Task management</li></ul></p><p><ul><li>Unified messaging</li></ul></p><p></p><p></p><p><h2> What Is ProxyShell?</h2></p><p><strong>ProxyShell</strong> is the name for a <strong>chain of three critical vulnerabilities</strong> in Microsoft Exchange Server that, when combined, allow <strong>unauthenticated remote code execution (RCE)</strong>. It was publicly weaponized in <strong>2021</strong> and used widely in <strong>real-world attacks</strong> (including by ransomware gangs and APTs).</p><p></p><p><ol><li><strong>CVE-2021-34473</strong> – Pre-auth path confusion vulnerability (bypass access control).</li></ol></p><p><ol><li><strong>CVE-2021-34523</strong> – Elevation of privilege in Exchange PowerShell backend.</li></ol></p><p><ol><li><strong>CVE-2021-31207</strong> – Post-auth arbitrary file write vulnerability.</li></ol></p><p></p><p>Together, these allow:<ul><li><strong>Unauthenticated attackers</strong> to reach internal Exchange PowerShell endpoints.</li></ul></p><p><ul><li>Write <strong>web shells</strong> to disk.</li></ul></p><p><ul><li>Gain <strong>persistent RCE</strong> as SYSTEM on the target server.</li></ul></p><p></p><p></p><p></p><p><h3> Attack Chain Summary:</h3><ol><li>Attacker crafts a request to <code>AutoDiscover</code>/<code>PowerShell</code> endpoints, bypassing auth.</li></ol></p><p><ol><li>Gains access to Exchange backend over port 443 (HTTPS).</li></ol></p><p><ol><li>Uses <strong>PowerShell command injection</strong> to drop a web shell (e.g., ASPX).</li></ol></p><p><ol><li>Executes arbitrary commands or moves laterally within the internal network.</li></ol></p><p></p><p></p><p><h2>Why It Matters:</h2><ul><li>No user interaction needed.</li></ul></p><p><ul><li>Works over HTTPS.</li></ul></p><p><ul><li>Affects public-facing Exchange instances.</li></ul></p><p><ul><li>Used in mass exploitation campaigns (e.g., Hafnium, ransomware operators).</li></ul></p><p></p><p></p><p></p><p><h2>Mitigation:</h2><ul><li>Apply <strong>Microsoft patches</strong> for all 3 CVEs.</li></ul></p><p><ul><li>Disable <strong>unnecessary exposure</strong> of Exchange servers.</li></ul></p><p><ul><li>Monitor for abnormal ASPX uploads and suspicious RPS access.</li></ul></p><p><ul><li>Use <strong>EDR</strong> solutions and <strong>network segmentation</strong> to limit lateral movement.</li></ul></p><p></p></div>
</body>
</html>
