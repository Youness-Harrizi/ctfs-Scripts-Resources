<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Ps-remote</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Ps-remote</h1><br/><p><ul><li>PS Remote is a PowerShell script that allows an attacker to remotely execute PowerShell commands on a target system</li><li></li></ul><div class="codebox"><pre><span style="color:#0088ff;font-weight:400"># enable ps-remoting in both source and dest </span><br /><span style="color:#ff9d00;font-weight:700">Enable-PsRemoting</span><br /><span style="color:#0088ff;font-weight:400"># add all hosts to trusted lists</span><br /><span style="color:#ff9d00;font-weight:700">Set-Item</span> WSMan<span style="color:#ff9d00;font-weight:700">:</span>localhost<span style="color:#ff9d00;font-weight:700">\</span>client<span style="color:#ff9d00;font-weight:700">\</span>trustedhosts <span style="color:#333333;font-weight:400">-value</span> <span style="color:#ff9d00;font-weight:700">*</span><br /><span style="color:#0088ff;font-weight:400"># test if ps-remotng is enabled (requires winrm service enabled)</span><br /><span style="color:#00117f;font-weight:400">Test-NetConnection</span> <span style="color:#ff9d00;font-weight:700">-</span>Port <span style="color:#333333;font-weight:400">5985</span> <span style="color:#ff9d00;font-weight:700">-</span>ComputerName <span style="color:#0088ff;font-weight:400">$target</span> <br /><span style="color:#0088ff;font-weight:400"># method 1</span><br /><span style="color:#ff9d00;font-weight:700">invoke-command</span> <span style="color:#ff9d00;font-weight:700">-</span>ComputerName <span style="color:#0088ff;font-weight:400">$target</span> <span style="color:#ff9d00;font-weight:700">-</span>Scriptblock {whoami} <br /><span style="color:#0088ff;font-weight:400"># method 2</span><br /><br /><span style="color:#0088ff;font-weight:400">$s</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-PSSession</span> <span style="color:#ff9d00;font-weight:700">-</span>ComputerName <span style="color:#0088ff;font-weight:400">$target</span> <span style="color:#ff9d00;font-weight:700">-</span>Credentials <span style="color:#0088ff;font-weight:400">$user</span><br /><span style="color:#ff9d00;font-weight:700">Enter-PSSession</span> <span style="color:#ff9d00;font-weight:700">-</span>Session <span style="color:#0088ff;font-weight:400">$s</span><br /><span style="color:#ff9d00;font-weight:700">Invoke-Command</span> <span style="color:#ff9d00;font-weight:700">-</span>FilePath <span style="color:#0088ff;font-weight:400">$file</span>.ps1 <span style="color:#ff9d00;font-weight:700">-</span>Session <span style="color:#0088ff;font-weight:400">$s</span> </pre></div></p></div>
</body>
</html>
