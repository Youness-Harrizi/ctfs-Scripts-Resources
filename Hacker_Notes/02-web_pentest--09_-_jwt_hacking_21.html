<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>09 - jwt hacking</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>09 - jwt hacking</h1><br/><p><h1>recognizing a JWT token</h1><ul><li><h3>starts with ey and contains 3 parts seperated by dots  header.paylaod.signature</h3></li><li><h3> header={&quot;TYP&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;HS256&quot;} # alg is the encryption algorithm to sign the token</h3></li><li><h3> signature=HS256(Header+payload) with a secret key</h3></li><li><h3> base64 encoded</h3></li></ul><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h1>attack 1 : none algorithm attack</h1><ul><li><h3>when the app supports Non algorithm , you can forge JWT</h3><ul><li><h3>alg: &quot;none&quot; </h3></li><li><h3>u modify payload </h3></li><li><h3>POST request =&gt; login </h3></li></ul></li></ul><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h1>attack 2 : changing from RS256 =&gt; HS 256</h1><h3></h3></p><p><h3> * RS256 = Â asymetric (public key + private key)</h3><h3></h3></p><p><h3> * HS256 = symetric( one key )</h3><h3></h3></p><p><h3> * if we perform the attack and we know the public key =&gt; we can forge a token</h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h1>attack 3 : signature not checked</h1><ul><li><h3>sometimes developers forget to check the signature</h3></li></ul><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h1>attack4 : bruteforce the key in HS256</h1><h3></h3></p><p><h3> </h3><ul><li><h3>tools : jwtbrute / JWT cracker</h3></li><li><h3> https://github.com/jmaxxz/jwtbrute</h3></li><li><h3>https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqbFJxSWI1bHVOblRTQnpZOXB0Nm5KeHJWT2FOUXxBQ3Jtc0trajZSamFhcHkxRUxCc0VEQ3l3blVPeHlxdGJGcXBjVURISEFSQXVUVldleVZRQVNFRms2Q29sM0lRVm1FR0xlWGh0MWVoeHktbmNqOWR3UXdRazI4cVJBZFdmV0FHaERRbE9HX2hwM2hVOENqRlV0QQ&amp;q=https%3A%2F%2Fgithub.com%2Fbrendan-rius%2Fc-jwt-cracker</h3></li></ul><h3></h3></p><p><h3></h3></p><p><strong><h2>web tool :</h2></strong><h3></h3></p><p><h3> * https://jwt.io/</h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h1>attack 5 : exploiting &quot;kid&quot; optional header</h1><h3></h3></p><p><h3> * kid is an optional header claim which holds a key identifier, particularly useful when you have multiple keys to sign the tokens and you need to look up the right one to verify the signature.</h3><h3></h3></p><p><h3> * reveal key possibility : If the claim &quot;kid&quot; is used in the header, check the web directory for that file or a variation of it. For example if &quot;kid&quot;:&quot;key/12345&quot; then look for /key/12345 and /key/12345.pem on the web roo</h3><h3></h3></p><p><h3> * *Path traversal : changing key* : idea if you can change the path to the &quot;kid value&quot; or maybe try &quot;kid&quot;:&quot;/dev/tcp/yourIP/yourPort&quot;</h3><h3></h3></p><p><h3> * OS injection and SQL injection arre also possible</h3><h3></h3></p><p><h3> </h3></p></div>
</body>
</html>
