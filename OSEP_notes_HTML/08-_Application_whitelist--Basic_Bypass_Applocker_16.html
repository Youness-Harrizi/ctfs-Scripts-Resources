<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Basic Bypass Applocker</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Basic Bypass Applocker</h1><br/><p><h2>Writable trusted folders</h2><ul><li>The default rules for AppLocker whitelist all executables and scripts located in <strong>C:\Program Files, C:\Program Files (x86), and C:\Windows</strong></li><li>check if writable <ul><li><strong>accesschk.exe &quot;student&quot; C:\Windows -wus</strong></li></ul></li><li>check for each folder if executable<ul><li><strong>icacls.exe c:\windows\tasks</strong></li><li></li></ul></li></ul><img src="images/16-1.png" alt="images/16-1.png" /></p><p></p><p></p><p><h2>Bypass with dlls</h2><ul><li>• <small>• default rules doesn&#39;t protect against the execution of dlls </small></li><li><small>load unmanaged arbitrary dlls </small></li><li><small>rundll32 c:\tools\shell.dll,run</small></li><li><small>ps we can enforce dll whitelisting in applocker </small><ul><li><small>try copying to c:\windows\tasks</small></li></ul></li></ul></p><p></p><p><h2>Alternate data streams</h2><ul><li>windows supports different data streams for a file</li><li>if we can find writable and executable file in a trusted folder we could write the context of our script to an alternate data stream </li><li>e.g temviewer.log<ul><li></li></ul></li></ul><img src="images/16-2.png" alt="images/16-2.png" /> </p><p></p><p></p><p><h2>Third party execution</h2><ul><li>aplocker default only enforce it against native windows executable file types</li><li>if a script engine like python or perl is installed we can eaily bypass whitelisting</li></ul></p><p></p><p></p><p><h2>Other methods</h2><ul><li>js (wscript $js)<ul><li>dotnettojscript</p><p></li></ul></li></ul></p></div>
</body>
</html>
