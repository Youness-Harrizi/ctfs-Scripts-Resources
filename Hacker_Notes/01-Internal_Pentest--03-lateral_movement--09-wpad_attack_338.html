<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>09-wpad_attack</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>09-wpad_attack</h1><br/><p><ul><li><h3>Organisations typically allow access to the web through intermediary servers called proxies to improve performance, monitoring and security.•</h3></li><li><h3> But that creates a &quot;chicken-and-egg” problem: how to tell the browsers inside the network which proxy server to user in order to get web access in the first place?</h3></li></ul><h3></h3></p><p><h3></h3><ul><li><h3> The easiest way to answer that question is with a configuration file called a PAC (proxy auto-config) file that sets the browser up automatically.</h3></li></ul><a name="h3-3"></a><ul><li>So, before it can find the proxy server, a web browser needs to know: </li></ul><a name="h3-4"></a><ul><li>And that’s where WPAD comes in – a WPAD-enabled browser will automatically look for a PAC file called wpad.dat on the local network </li></ul><a name="h3-5"></a></p><p> The browser works out where to look by using the network name of the computer it’s on. A browser on a computer with the network name computer.team.division.company.example in the following order<a name="h3-6"></a><ul><li> wpad.team.division.company.example</li></ul><a name="h3-7"></a><ul><li>wpad.dat wpad.division.company.example</li></ul><a name="h3-8"></a><ul><li>wpad.dat wpad.company.example/wpad.dat </li></ul><a name="h3-9"></a></p><p><a name="h3-10"></a><ul><li>  This is dangerous because if attackers were able to purchase the domain name and publish their own PAC file that tells browsers to use the attacker’s proxy server..company.example hey could put up a website at wpad.company.example◇ situation u have proxy litening (e?g port 1080) on attacker side </li></ul><a name="h3-11"></a><ul><li> attacker shares via smb wpad.dat (malicious file) on the network </li><li> wpad is enabled by default in windows and internet explorer</li><li>LAN settings =&gt; automatically detect settings </li></ul><a name="h3-14"></a></p><p></p><p> ◇ goal: intercept traffic </p></div>
</body>
</html>
