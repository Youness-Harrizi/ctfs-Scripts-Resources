<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>18- Insecure deseralization</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>18- Insecure deseralization</h1><br/><p><ol><li><h2>PHP object injection</h2></li></ol></p><p><ul><li>example vulnerable code<ul><li>up_cookie = base64_encode(serialize(new UserPrefs()));</li></ul></li><li>Steps<ul><li>look for a funnction in a class that is interesting </li><li>look for magic methods that are excuted upon creation of the object</li><li>reproduce the code </li><li>$obj=new Objectvuln()</li><li>$obj -&gt; attr1= â€˜exploit&#39;</li><li>echo base64_encode(serialize($obj));</li></ul></li></ul></p><p> </p></div>
</body>
</html>
