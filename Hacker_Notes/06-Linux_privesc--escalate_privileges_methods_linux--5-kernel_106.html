<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5-kernel</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>5-kernel</h1><br/><p></p><p><strong><h2>Detect</h2></strong><ul><li>cat /etc/issue<ul><li>// system identification</li></ul></li><li>uname -r<ul><li>kernel version</li></ul></li><li>arch<ul><li>architecture</li></ul></li><li>searchsploit linux kernel &lt;system ID&gt;<ul><li>searchsploit linux kernel ubuntu 16.04 local privilege escalation</li></ul></li></ul></p><p><h2>dirty cow : cve2016-5195</h2><ul><li>local privilege escalation</li><li>vulnerability in linux kernel</li><li>allow to write to a file owned by root</li><li>./dirty cow filename string_to_write</li><li><a href="http://string_to_write">• </a>• race condition vulnerabilities</li><li><a href="https://www.exploit-db.com/exploits/40839">https://www.exploit-db.com/exploits/40839</a></li><li>Linux Kernel 2.6.22 &lt; 3.9 - &#39;Dirty COW&#39; &#39;PTRACE_POKEDATA&#39; Race Condition Privilege Escalation (/etc/passwd Method)</li></ul></p><p></p><p></p><p><h2>dirty cow application</h2><ul><li><h3>• </h3>• linuxsuggester.sh<ul><li> detect dirty cow</li></ul></li><li>gcc -o c0w<ul><li> ./cow; passwd</li><li> to reset changes cp /tmp/bak /usr/bin/passwd</li></ul></li></ul></p><p></p><p></p><p><h2> CVE-2021-4034: pwnkit</h2><ul><li>detection<ul><li> look for poolkitd in  D-bus services </li><li>kernel version<ul><li>cat /etc/os-release</li></ul></li></ul></li><li>overview<ul><li>a memory corruption vuln in Polkit pkexec which allows privesc to root from any user when using default polkit config </li></ul></li><li>exploit<ul><li><a href="https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation">https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation</a></li><li>./poc.sh -u=t -p=p</li><li>/var/www/html/PwnKit32</li></ul></li></ul></p><p></p><p></p><p><h2>CVE-2021-3156: sudoedit</h2></p><p><ul><li>Sudo before 1.9.5p2 contains an off-by-one error that can result in a heap-based buffer overflow, which allows privilege escalation to root via &quot;sudoedit -s&quot; and a c</li></ul></p><p>mmand-line argument that ends with a single backslash character.<ul><li>poc<ul><li><a href="https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py">https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py</a></li></ul></li></ul></p><p></p><p></p><p><h2>Compiling 32 bit machines</h2><ul><li>gcc -m32 -Wl,--hash-style=both -o 9545_new 9545.c</li></ul></p><p></p><p></p><p><em><h2>xenspawn compiler</h2></em><ul><li><a href="https://github.com/X0RW3LL/XenSpawn">https://github.com/X0RW3LL/XenSpawn</a></li><li>cd /var/lib/machine  //put exploit.c</li><li>sudo systemd-nspawn -M MACHINE_NAME</li><li>sudo systemd-nspawn -M ubuntu5.4</li><li>cd /opt</li><li>ls</li><li>pwd</li><li>whoami</li><li></li></ul></p><p></p><p></p><p><strong><h2>CAN BCM Local Privilege Escalation</h2></strong><ul><li>requirements<ul><li>Linux Kernel &lt; 2.6.36-rc1</li></ul></li></ul></p><p></p><p></p><p></p><p><strong><h2>Ubuntu 16.04 exploit</h2></strong><ul><li>45010<ul><li>linux Kernel &lt; 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privilege Escalation</li></ul></li></ul></p><p></p><p><strong><h2>Compile 32 bites</h2></strong><ul><li>gcc -m32 -Wl,--hash-style=both -o exploit 9542.c</li></ul></p><p></p><p></p><p><strong><h2>Overcome gcc old versions</h2></strong><ul><li>docker pull gcc:4.9</li><li>docker run --rm -v &quot;$PWD&quot;:/usr/src/myapp -w /usr/src/myapp gcc:4.9 gcc -o exploit 9542.c</li></ul></p></div>
</body>
</html>
