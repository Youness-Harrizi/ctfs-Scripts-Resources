<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>02</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>02</h1><br/><p>I<strong>nitial Foothold</strong>:<ul><li><strong>Identify</strong> machines with port 25 (SMTP) open for email spoofing and port 80 for web services.</li><li><strong>Craft a modified Meterpreter payload</strong> (<code>met.exe</code>) to evade antivirus detection, using a custom C# application named <code>Helper</code> and another named <code>Met</code> to encode and execute the payload.</li></ul></p><p></p><p><ul><li><strong>AV Evasion Payload Execution</strong>:</li><li>The payload, crafted with <code>msfvenom</code> and encoded in C#, is designed to bypass antivirus software by modifying the payload bytes and executing it in memory without touching the disk.</li></ul></p><p></p><p><ul><li><strong>Delivery and Execution</strong>:</li><li><strong>Create an HTA file</strong> that, when opened, executes a PowerShell command to download and run the Meterpreter payload (<code>Met.exe</code>) from a controlled server.</li><li><strong>Use Swaks</strong> for email spoofing to deliver the HTA file to the target, simulating a phishing attack to gain initial access.</li></ul></p><p></p><p><ul><li><strong>Privilege Escalation and Credential Access</strong>:</li><li>Upon gaining shell access, <strong>find sensitive files</strong> like <code>mail.ps1</code> in <code>C:\ProgramFiles\Setup</code> to extract credentials.</li><li><strong>Execute PowerShell scripts remotely</strong> to download additional tools like <code>PowerView</code> for further enumeration and privilege escalation.</li></ul></p><p></p><p><ul><li><strong>Lateral Movement</strong>:</li><li><strong>Enumerate the domain</strong> using tools like <code>SharpHound</code>.</li><li><strong>Set up a SOCKS proxy</strong> with <code>autoroute</code> in Metasploit and use <code>proxychains</code> for network pivoting and accessing additional systems.</li></ul></p><p></p><p><ul><li><strong>Domain Privilege Escalation</strong>:</li><li>Exploit SQL servers&#39; link to <strong>perform NTLM relay attacks</strong>, dumping SAM databases to extract administrative credentials.</li><li><strong>Use local admin hashes</strong> to enable RDP, disable antivirus, and execute <code>mimikatz</code> for further credential dumping and lateral movement.</li></ul></p><p></p><p><ul><li><strong>Persistence and Exfiltration</strong>:</li><li><strong>Manipulate system settings</strong> to ensure persistence, such as disabling Windows Defender real-time monitoring and enabling RDP.</li><li><strong>Exploit RBCD (Resource-Based Constrained Delegation)</strong> to gain execution as a highly privileged service account on targeted machines.</li><li><strong>Insert reverse shells</strong> and use port forwarding to maintain access and exfiltrate data.</li></ul></p><p></p><p><ul><li><strong>Final Exfiltration</strong>:</li><li><strong>Perform command injection</strong> on a web application to gain shell access on a critical server, reading sensitive files like <code>secret.txt</code>.</li></ul></p><p></p><p></p></div>
</body>
</html>
