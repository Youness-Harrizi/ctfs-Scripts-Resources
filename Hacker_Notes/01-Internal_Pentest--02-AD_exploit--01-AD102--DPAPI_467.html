<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DPAPI</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>DPAPI</h1><br/><p><h2>Intro</h2></p><p><ul><li>DPAPI : data protection api <ul><li>permet à diverses apps de stocker des données sensibles (par exemple mdp )</li><li>les données sont stockés sur </li></ul></li></ul><img src="images/467-1.png" alt="images/467-1.png" /> et sont securisés par des clés derivés du mot de passe user <ul><li></li></ul><img src="images/467-2.png" alt="images/467-2.png" /><ul><li>types de données<ul><li></li></ul></li></ul><img src="images/467-3.png" alt="images/467-3.png" /><ul><li></li></ul></li><li>l&#39;outil se base sur impacket probablement smbexec puis collecte une master key sur un disk puis dechifre via la clé derivé du passe de l(utilsateur puis utiliser la master key pour dechiffrer le fichier </li><li>un admin de domain pourra lever   la protection dpapi sur tous les utilisateurs de domaine </p><p></p><p></p><p><h2>exploit</h2><ul><li>proxychains donpapi gui </li><li></li></ul><img src="images/467-4.png" alt="images/467-4.png" /><ul><li></li></ul><img src="images/467-5.png" alt="images/467-5.png" /></p><p></p><p></p><p><ul><li>en pentest OK en red team c&#39;est pas discret vu que c&#39;est pas fin </li></ul></p></div>
</body>
</html>
