<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>24-SCCM</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>24-SCCM</h1><br/><p>Here&#39;s a concise but technically solid breakdown of <strong>SCCM</strong> and its <strong>attack surface</strong>, tailored for offensive security and red teaming contexts:</p><p></p><p><h2>ğŸ§­ What is </h2><strong><h2>SCCM</h2></strong><h2>?</h2></p><p><strong>SCCM</strong> (System Center Configuration Manager), now renamed <strong>Microsoft Endpoint Configuration Manager (MECM)</strong>, is an <strong>enterprise systems management tool</strong> developed by Microsoft.</p><p>Itâ€™s used for:<ul><li><strong>Pushing software and patches</strong> to endpoints.</li></ul></p><p><ul><li><strong>Deploying OS images</strong>.</li></ul></p><p><ul><li><strong>Inventory management</strong> (hardware/software).</li></ul></p><p><ul><li><strong>Remote administration</strong>.</li></ul></p><p><ul><li><strong>Configuration enforcement</strong> (e.g., GPO-like settings).</li></ul></p><p><ul><li><strong>Compliance reporting</strong>.</li></ul></p><p></p><p></p><p>SCCM typically operates in large enterprise environments and has high privileges across the network.</p><p></p><p><h2>ğŸ“Œ SCCM Architecture (Attack-Relevant Components)</h2><ul><li><strong>Primary Site Server</strong>: Central authority for client management.</li></ul></p><p><ul><li><strong>Management Point (MP)</strong>: Handles communication between SCCM clients and server.</li></ul></p><p><ul><li><strong>Distribution Point (DP)</strong>: Delivers content (software updates, apps, OS images).</li></ul></p><p><ul><li><strong>Client Agent</strong>: Runs on endpoints with SYSTEM-level access.</li></ul></p><p><ul><li><strong>Admin Console</strong>: Used by IT admins (often high privilege accounts).</li></ul></p><p><ul><li><strong>Database (SQL Server)</strong>: Central data repository (valuable for recon or lateral movement).</li></ul></p><p></p><p></p><p></p><p><h2>ğŸ’£ Attacks Against SCCM</h2></p><p><ol><li>1. <h3>1. ğŸ” </h3><strong><h3>Reconnaissance</h3></strong></li><li>Query SCCM client configurations via WMI or registry to gather:</li><li>MP/DP server names</li></ol></p><p><ul><li>Site codes</li></ul></p><p><ul><li>Installed software / patch status</li></ul></p><p></p><p></p><p><ul><li>Find <strong>GPO-like compliance scripts</strong> or triggers.</li></ul></p><p></p><p></p><p><ol><li>2. <h3>2. ğŸ› ï¸ </h3><strong><h3>Abusing Client-Agent Trust</h3></strong></li><li>SCCM agents run as <strong>SYSTEM</strong> and <strong>trust signed packages</strong>.</li></ol></p><p><ul><li>If you compromise the site server or have administrative access:</li><li>Push <strong>malicious MSI/EXE</strong> to all connected clients.</li></ul></p><p><ul><li>Deploy <strong>custom task sequences</strong> or scripts.</li></ul></p><p><ul><li>Abuse <strong>compliance settings</strong> to implant backdoors.</li></ul></p><p></p><p></p><p></p><p></p><p>ğŸ’€ Once an attacker owns the SCCM console or DP, it&#39;s <em>effectively game over</em> for domain-wide persistence.</p><p><ol><li>3. <h3>3. ğŸ“¦ </h3><strong><h3>Malicious Content Distribution</h3></strong></li><li>Poison <strong>Distribution Points</strong> (DPs) with trojanized payloads.</li></ol></p><p><ul><li>Replace legitimate software updates with backdoored versions.</li></ul></p><p></p><p></p><p><ol><li>4. <h3>4. ğŸ§° </h3><strong><h3>Abuse of Task Sequences / OS Deployment</h3></strong></li><li>Inject <strong>malware into OS deployment images</strong>.</li></ol></p><p><ul><li>Add persistence scripts to run on every system reinstall or new deployment.</li></ul></p><p></p><p></p><p><ol><li>5. <h3>5. ğŸ¯ </h3><strong><h3>Privilege Escalation</h3></strong></li><li>Exploit misconfigured <strong>SCCM site permissions</strong> (e.g., low-priv user able to modify deployments).</li></ol></p><p><ul><li>Harvest <strong>cleartext credentials</strong> from:</li><li>SCCM SQL DB (e.g., service accounts).</li></ul></p><p><ul><li>Client logs.</li></ul></p><p><ul><li>Task sequence variables.</li></ul></p><p></p><p></p><p></p><p></p><p><ol><li>6. <h3>6. ğŸ“¡ </h3><strong><h3>Pivoting / Lateral Movement</h3></strong></li><li>Use SCCM&#39;s reach to pivot into <strong>isolated VLANs</strong>.</li></ol></p><p><ul><li>Compromise <strong>admin consoles</strong> for lateral escalation.</li></ul></p><p></p><p></p><p></p><p><h2>ğŸ§ª Real-World Techniques</h2></p><p><table class="table"><tr><th>Technique</th><th>Description</th></tr><tr><td>Living off the SCCM Land</td><td>Using SCCMâ€™s built-in tools (WMI, client push) to execute payloads.</td></tr><tr><td>DLL Sideloading</td><td>Planting malicious DLLs in app deployment bundles.</td></tr><tr><td>Fake Application Deployment</td><td>Creating decoy apps (e.g., Chrome installer) with added malware.</td></tr><tr><td>Script-based Exploitation</td><td>Leveraging deployment scripts to implant reverse shells, C2 beacons.</td></tr></table></p><p></p><p><h2>ğŸ” Mitigations</h2><ul><li><strong>Restrict SCCM admin access</strong> (least privilege).</li></ul></p><p><ul><li>Use <strong>code signing</strong> and enforce validation.</li></ul></p><p><ul><li>Monitor SCCM logs for unusual deployments.</li></ul></p><p><ul><li>Isolate DPs and use <strong>HTTPS communication</strong>.</li></ul></p><p><ul><li>Apply <strong>RBAC</strong> within the SCCM console.</li></ul></p><p></p><p></p><p>Want a <strong>YouTube demo</strong> summary or <strong>sample payload</strong> used in SCCM abuse? I can fetch or summarize one for you.</p></div>
</body>
</html>
